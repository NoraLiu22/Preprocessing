xcckdesmlshkfqhikcfquogcnghsxemsigngymoq length 5 21167 page 21167 


<!DOCTYPE HTML><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" type="text/css" href="https://www.giss.nasa.gov/css/css2104.css" media="all" />


<title>NASA GISS: Scattering -- Bidirectional Reflectance Codes</title>
<link rel="apple-touch-icon" href="/gfx/apple-touch-icon-180x180.png" />
<link rel="apple-touch-icon-precomposed" href="/gfx/apple-touch-icon-180x180.png" />
<link rel="apple-touch-icon" sizes="192x192" href="/gfx/apple-touch-icon-192x192.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/gfx/apple-touch-icon-180x180.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/gfx/apple-touch-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="128x128" href="/gfx/apple-touch-icon-128x128.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/gfx/apple-touch-icon-76x76.png" />
<meta name="orgcode" content="611" />
<meta name="rno" content="Gavin.A.Schmidt.1" />
<meta name="content-owner" content="Robert.B.Schmunk.1" />
<meta name="webmaster" content="Robert.B.Schmunk.1" />
<meta name="viewport" content="width=956, initial-scale=1" /><script id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NASA&amp;subagency=GISS&amp;yt=true&amp;dclink=true&amp;pua=UA-52099626-1" async="async"></script>
</head>
<body>
<div id="bkg1"><div id="bkg2"></div><!-- end bkg2 --></div><!-- end bkg1 -->
<div id="page">
<div id="archive">
<p>This page's content is no longer actively maintained, but the material has been kept on-line for historical purposes.<br />The page may contain broken links or outdated information, and parts may not function in current web browsers.</p></div>
<div class="hidden">
<a href="#content" title="Go to Main Content" accesskey="2">Go to Main Content (Accesskey 2)</a><br /><a href="#nav" title="Go to Site Menu" accesskey="3">Go to Site Menu (Accesskey 3)</a></div><!-- end hidden -->
<div id="header">
<div id="headerlogo">
<a href="https://www.nasa.gov/"><img src="https://www.giss.nasa.gov/gfx/2013/nasa_x2.png" alt="NASA Logo, National Aeronautics and Space Administration" style="width:140px;height:98px" /></a></div><!-- end headerlogo -->
<div id="centername">
<h1><a href="https://www.nasa.gov/">National Aeronautics and Space Administration</a></h1>
<h2><a href="https://www.giss.nasa.gov/">Goddard Institute for Space Studies</a></h2></div><!-- end centername -->
<div id="hierarchy">
<h2><a href="https://www.nasa.gov/goddard/">Goddard Space Flight Center</a><br /><a href="https://science.gsfc.nasa.gov/sci">Sciences and Exploration Directorate</a><br /><a href="https://science.gsfc.nasa.gov/earth">Earth Sciences Division</a></h2></div><!-- end hierarchy --></div><!-- end header -->
<div id="paper">
<div id="content"><div id="cpad">


<h2>Electromagnetic Scattering by Particles and Surfaces</h2>

<h3>Fortran Codes for the Computation of (Polarized) Bidirectional 
Reflectance of Flat Particulate Layers and Rough Surfaces</h3>


<div style="border:dotted red 2px;padding:8px;margin:12px 36px">
<p style="text-align:center;padding-bottom:0;margin:0">
Please note that
<a href="/staff/mmishchenko/mishchenko.html">Dr. Michael I. Mishchenko</a>
<a href="https://www.giss.nasa.gov/research/news/20200727/">passed away in July 2020</a>.
We do not expect that the information presented on these Electromagnetic Scattering research pages will be updated with new data.
</p>
</div>



<p class="byline">By
Michael I. Mishchenko
and
Nadia T. Zakharova</p>

<p>
This webpage provides access to three collections of Fortran codes.
</p>






<div class="floatright">
<img src="brf.gif" style="width:225px;height:249px;border:0" alt="Sample BRF plot" />
</div>




<p>
The first one can be used to compute the scalar bidirectional reflectance of a semi-infinite homogeneous slab composed of arbitrarily shaped, randomly oriented particles based on a rigorous numerical solution of the radiative transfer equation.  
</p>

<p>
The second one can be used to compute the polarized bidirectional reflectance of a semi-infinite homogeneous slab composed of arbitrarily shaped, randomly oriented particles based on a rigorous numerical solution of the vector radiative transfer equation.  
</p>

<p>
The third one can be used to compute the Stokes reflection matrix of a rough interface separating two homogeneous half-spaces with different refractive indices (e.g., a rough ocean surface). 
</p>




<h4 style="font-size:1.125em;font-style:italic">
Particulate Semi-Infinite Layers: Scalar Case</h4>

<p>
The code brf.f solves the Ambartsumian's nonlinear integral equation for the reflection function using a simple iterative method. Since this technique bypasses the computation of the internal field, it is by far the fastest and most accurate numerical approach available. 
</p>

<P>
The codes are ideally suitable to computing the BRF for flat snow, soil, and powder surfaces and optically thick clouds and may find applications in geophysics, physics, biophysics, and industrial research.
</p>

<P>
A detailed user manual to the codes is provided by
M. I. Mishchenko, J. M. Dlugach, E. G. Yanovitskij, and N. T. Zakharova, 1999:
<a href="https://pubs.giss.nasa.gov/abs/mi07100z.html">
Bidirectional reflectance of flat, optically thick particulate layers:
An efficient radiative transfer solution and applications to snow and soil surfaces</a>,
<cite>J. Quant. Spectrosc. Radiat. Transfer</cite>, <b>63</b>, 409-432, doi:10.1016/S0022-4073(99)00028-X.</p>

<P>
The users of the code are encouraged to visit this page on a regular basis for information on latest developments, warnings, and/or errors found. We would highly appreciate informing us of any problems and errors encountered with these codes.
<!-- Please e-mail your questions and comments
to <a href="mailto:michael.i.mishchenko@nasa.gov">
michael.i.mishchenko@nasa.gov</a>. -->
</p>




<h4>Fortran codes</h4>

<p>To retrieve a code, click on the code name and use the "Save As..." 
option from the "File" menu.</p>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/refl.f">refl.f</a>
    - This code computes Fourier components of the reflection function</li>

<li><a href="/staff/mmishchenko/ftpcode/interp.f">interp.f</a>
    - This code computes the bidirectional reflection function for a given set of scattering geometries</li>

<li><a href="/staff/mmishchenko/ftpcode/spher.f">spher.f</a>
    - This code computes the Legendre expansion coefficients for polydisperse spherical particles using the standard Lorenz-Mie theory</li>
</ul>

<p>
The codes must be run in the following sequence:  spher.f -&gt; refl.f -&gt; interp.f.
</p>

<p>
Note that the Legendre expansion coefficients for polydisperse, randomly oriented nonspherical particles and sphere aggregates can be computed using
<a href="/staff/mmishchenko/tmatrix/">
T-matrix codes</a>.
The expansion coefficients for the standard and double-peaked Henyey-Greenstein phase functions are computed using Eqs. (15) and (19) of the manual.  Below we also provide the Legendre expansion coefficients for two nonspherical ice particle models described in the manual.
</p>



<h4>Benchmark Results</h4>

<p>
The following output files were computed by the codes in their current settings and may provide a useful test of the performance of the codes on different computers:
</p>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/spher.print">spher.print</a></li>
<li><a href="/staff/mmishchenko/ftpcode/spher.write">spher.write</a></li>
<li><a href="/staff/mmishchenko/ftpcode/refl.print">refl.print</a></li>
<li><a href="/staff/mmishchenko/ftpcode/interp.write">interp.write</a></li>
</ul>

<p>The file refl.write is not given here because of its large size.</p>



<h4>Legendre coefficients for two ice particle models</h4>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/macke.column.write">Hexagonal columns</a></li>
<li><a href="/staff/mmishchenko/ftpcode/macke.smooth.write">Random fractal crystals</a></li>
</ul>


<h4 style="font-size:1.125em;font-style:italic">
Particulate Semi-Infinite Layers: Full Vector Case</h4>

<p>
The Fortran program pbrf.f solves the vector Ambartsumian's nonlinear integral equation for the Stokes reflection matrix using a simple iterative method.  Since this technique bypasses the computation of the internal field, it is by far the fastest and most accurate numerical approach available. 
</p>

<p>
A detailed user manual to the code is provided by
Mishchenko, M.I., J.M. Dlugach, J. Chowdhary, and N.T. Zakharova, 2015:
<a href="https://pubs.giss.nasa.gov/abs/mi02120e.html">
Polarized bidirectional reflectance of optically thick sparse particulate layers: An efficient numerically exact radiative-transfer solution</a>.
<cite>J. Quant. Spectrosc. Radiat. Transfer</cite>, <b>156</b>, 97-108, doi:10.1016/j.jqsrt.2015.02.003.
</p>


<P>
The users of the program are encouraged to visit this page on a regular basis for information on latests developments, warnings, and/or errors found. We would highly appreciate informing us of any problems and errors
encountered with this program.
<!--
Please e-mail your questions and comments
to <a href="mailto:michael.i.mishchenko@nasa.gov">
michael.i.mishchenko@nasa.gov</a>.
-->
</p>



<h4>Fortran codes</h4>

<p>To retrieve a code, click on the code name and use the "Save As..." 
option from the "File" menu.</p>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/pbrf.f">pbrf.f</a>
    - This code computes Fourier components of the reflection matrix</li>
<li><a href="/staff/mmishchenko/ftpcode/pbrf.par.f">pbrf.par.f</a>
    - This code must be stored in the same directory as pbrf.f</li>
<li><a href="/staff/mmishchenko/ftpcode/spher.pbrf.f">spher.pbrf.f</a>
    - This code computes the expansion of the Stokes scattering matrix in generalized spherical functions for polydisperse spherical particles using the standard Lorenz-Mie theory</li>
</ul>

<p>
The codes must be run in the following sequence:  spher.f -&gt; pbrf.f
</p>

<p> Note that the expansion coefficients for polydisperse, randomly oriented nonspherical particles and sphere aggregates can be computed using
<a href="/staff/mmishchenko/tmatrix/">
T-matrix codes</a>.
</p>

<h4>Benchmark results</h4>

<p>
The following output files were computed by the codes in their current settings and may provide a useful test of the performance of the codes on different computers:
</p>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/spher_Venus.print">spher_Venus.print</a></li>
<li><a href="/staff/mmishchenko/ftpcode/spher_Venus.write">spher_Venus.write</a></li>
<li><a href="/staff/mmishchenko/ftpcode/pbrf_Venus_Gauss.print">pbrf_Venus_Gauss.print</a></li>
</ul>

<p>The file pbrf.write is not given here because of its large size.</p>


<h4 style="font-size:1.125em;font-style:italic">
Expansion of Tabulated Scattering Matrices in Generalized Spherical Functions</h4>

<p>
A detailed user manual to the computer program is provided by
Mishchenko, M.I., I.V. Geogdzhayev, and P. Yang, 2016:
<a href="https://pubs.giss.nasa.gov/abs/mi06220s.html">
Expansion of tabulated scattering matrices in generalized spherical functions</a>.
<cite>J. Quant. Spectrosc. Radiat. Transfer</cite>, <b>183</b>, 78-84, doi:10.1016/j.jqsrt.2016.05.015.
</p>


<h4>Fortran codes</h4>

<p>To retrieve a code, click on the code name and use the "Save As..." 
option from the "File" menu.</p>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/spher_expan.f">spher_expan.f</a>
    - This code computes the generalized-function expansion of a tabulated scattering matrix.</li>
<li><a href="/staff/mmishchenko/ftpcode/params.h">params.h</a>
    - This code must be stored in the same directory as spher_expan.f</li>
</ul>


<h4 style="font-size:1.125em;font-style:italic">
Re-Expansion of a Scattering Matrix in Generalized Spherical Functions with Packing Density Correction</h4>

<p>
A detailed user manual to the computer program is provided by
Ito, G., M.I. Mishchenko, and T.D. Glotch, 2018:
<a href="https://pubs.giss.nasa.gov/abs/it01000b.html">
Radiative-transfer modeling of spectra of planetary regoliths using cluster- based dense packing modifications</a>.
<cite>J. Geophys. Res. Planets</cite>, <b>123</b>, no. 5, 1203-1220, doi:10.1029/2018JE005532.
</p>



<h4>Fortran code</h4>

<p>To retrieve the code, click on the code name and use the "Save As..." 
option from the "File" menu.</p>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/PackedMedia.f">PackedMedia.f</a>
    This code re-computes the generalized-function expansion of a "low-density" scattering matrix by incorporating dense-packing effects based on the static structure factor.</li>
</ul>



<h4 style="font-size:1.125em;font-style:italic">
Rough Surfaces</h4>

<P>
The code ocean.shadow.f calculates the Stokes reflection matrix for illumination from above for a statistically rough surface separating two half-spaces with different refractive indices. The effect of shadowing is included.
</p>

<P>
The code ocean.phase.f calculates Fourier components of the Stokes reflection matrix for illumination from above for a statistically rough surface separating two half-spaces with different refractive indices. The effect of shadowing is included.
</p>

<P>
A detailed user manual to the codes is provided by
M. I. Mishchenko and L. D. Travis, 1997:
<a href="https://pubs.giss.nasa.gov/abs/mi08000d.html">
Satellite retrieval of aerosol properties over the ocean using polarization as well as intensity of reflected sunlight</a>,
<cite>J. Geophys. Res.</cite>, <b>102</b>, 16989-17013, doi:10.1029/96JD02425.
<!--
A hardcopy reprint of this paper is available from Michael Mishchenko upon request.
Please leave a message at <a href="mailto:michael.i.mishchenko@nasa.gov">
michael.i.mishchenko@nasa.gov</a> indicating your name and mailing address.
-->
</p>

<P>
The users of the codes are encouraged to visit this page on a regular basis for information on latests developments, warnings, and/or errors found. We would highly appreciate informing us of any problems and errors encountered with these codes.
<!--
Please e-mail your questions and comments
to <a href="mailto:michael.i.mishchenko@nasa.gov">
michael.i.mishchenko@nasa.gov</a>.
-->
</p>

<h4>Fortran codes</h4>

<p>To retrieve a code, click on the code name and use the "Save As..." 
option from the "File" menu.</p>

<ul>
<li><a href="/staff/mmishchenko/ftpcode/ocean.shadow.f">ocean.shadow.f</a>
<li><a href="/staff/mmishchenko/ftpcode/ocean.phase.f">ocean.phase.f</a>
</ul>















<!--

<h4>Contact</h4>

<p>Please address all inquires about this research to
<a href="mailto:michael.i.mishchenko@nasa.gov">
Dr. Michael Mishchenko</a>.
</p>

-->









<p class="ednote">
PDF documents linked on these scattering pages
may be viewed using Adobe's free
<a href="http://www.adobe.com/products/acrobat/readstep.html">Acrobat Reader</a>.
</p>





<p style="padding: 8px; margin-top: 12px; border: solid #009 1px; text-align: center">

  <b><a href="/staff/mmishchenko/">Michael Mishchenko</a></b>
  <br />
  <a href="/staff/mmishchenko/publications/">Publications On-Line</a> &#124;
  <a href="/staff/mmishchenko/books/">Books</a> &#124;
  <a href="/staff/mmishchenko/tmatrix/"><i>T</i>-Matrix Database</a>
  <br />
  Codes: <a href="/staff/mmishchenko/tmatrix/"><i>T</i>-Matrix</a> &#124;
  <a href="/staff/mmishchenko/brf/">Bidirectional Reflectance</a> &#124;
  <a href="/staff/mmishchenko/Lorenz-Mie.html">Lorenz-Mie</a>

</p>









<div class="clear"></div></div><!-- end cpad --></div><!-- end content -->
<div id="nav"><h3>Site Menu</h3>
<ul id="mnav">
<li><a href="https://www.giss.nasa.gov/">GISS Home</a></li>
<li><a href="https://www.giss.nasa.gov/research/">News &amp; Features</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/research/">News &amp; Features Overview</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/projects/">Projects &amp; Groups</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/projects/">Projects Overview</a></li>
<li><a href="https://www.giss.nasa.gov/projects/gcm/">Global Climate Modeling</a></li>
<li><a href="https://www.giss.nasa.gov/projects/astrobio/">Astrobiology / ROCKE-3D</a></li>
<li><a href="https://www.giss.nasa.gov/projects/impacts/">Climate Impacts</a></li>
<li><a href="https://isccp.giss.nasa.gov/">ISCCP</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://data.giss.nasa.gov/">Datasets</a>
<ul class="mnav2">
<li><a href="https://data.giss.nasa.gov/">Datasets Overview</a></li>
<li><a href="https://data.giss.nasa.gov/gistemp/">GISTEMP Surface Temperature</a></li>
<li><a href="https://data.giss.nasa.gov/modelE/">Model E Simulations</a></li>
<li><a href="https://data.giss.nasa.gov/modelforce/">Model Forcings</a></li>
<li><a href="https://data.giss.nasa.gov/rocke3d/maps/">ROCKE-3D Simulations</a></li>
<li><a href="https://isccp.giss.nasa.gov/products/onlineData.html">ISCCP Data Products</a></li>
<li><a href="https://gacp.giss.nasa.gov/datasets/">GACP Data Products</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://pubs.giss.nasa.gov/">Publications</a>
<ul class="mnav2">
<li><a href="https://pubs.giss.nasa.gov/">Publications Overview</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2024.html">2024 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2023.html">2023 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2022.html">2022 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2021.html">2021 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2020.html">2020 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/inpress.html">Accepted &amp; In Press</a></li>
<li><a href="https://pubs.giss.nasa.gov/authors/">Author Bibliographies</a></li>
<li><a href="https://pubs.giss.nasa.gov/best.html">Annual Best</a></li>
<li><a href="https://pubs.giss.nasa.gov/cited.html">Most Cited</a></li>
<li><a href="https://pubs.giss.nasa.gov/dissertations.html">Dissertations</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/tools/">Software</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/tools/">Software Overview</a></li>
<li><a href="https://www.giss.nasa.gov/tools/modelE/">GCM Model E</a></li>
<li><a href="https://www.giss.nasa.gov/tools/panoply/">Panoply Data Viewer</a></li>
<li><a href="https://www.giss.nasa.gov/tools/gprojector/">G.Projector</a></li>
<li><a href="https://www.giss.nasa.gov/tools/mars24/">Mars24 Sunclock</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/edu/">Education</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/edu/">Education Overview</a></li>
<li><a href="https://www.giss.nasa.gov/edu/intern/">Internships</a></li>
<li><a href="https://www.giss.nasa.gov/edu/ccri/">CCRI</a></li>
<li><a href="https://www.giss.nasa.gov/edu/grad/">Graduate Study</a></li>
<li><a href="https://www.giss.nasa.gov/about/jobs/postdoc.html">Postdoc Research</a></li>
<li><a href="https://www.giss.nasa.gov/edu/res/">STEM Curriculum Modules</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/events/">Events</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/events/">Events Overview</a></li>
<li><a href="https://www.giss.nasa.gov/events/lunch/">Lunch Seminars</a></li>
<li><a href="https://www.giss.nasa.gov/events/past.html">Past Events</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/about/">About GISS</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/about/">About GISS</a></li>
<li><a href="https://www.giss.nasa.gov/about/management.html">Management Staff</a></li>
<li><a href="https://www.giss.nasa.gov/staff/">Personnel Directory</a></li>
<li><a href="https://www.giss.nasa.gov/about/visiting/">Visitors' Info</a></li>
<li><a href="https://www.giss.nasa.gov/about/jobs/">Employment</a></li></ul><!-- end mnav2 --></li></ul><!-- end mnav --></div><!-- end nav -->

<div id="endpaper"></div></div><!-- end paper -->
<div id="footer">
<div id="footerlogo">
<a href="https://www.nasa.gov"><img src="https://www.giss.nasa.gov/gfx/2013/nasa_x2.png" alt="NASA Logo, National Aeronautics and Space Administration" style="width:140px;height:98px" /></a></div><!-- end footerlogo -->
<div id="footersig"><a href="https://www.nasa.gov/goddard/" class="imageLink"><img src="https://www.giss.nasa.gov/gfx/2013/gsig.png" alt="Goddard Space Flight Center" style="width:172px;height:68px" /></a></div><!-- end footersig -->
<div id="footerinfo">
<p>Page updated: Jul 15, 2023</p>
<p>Website Curator:
<a href="https://www.giss.nasa.gov/staff/rschmunk.html">
Robert B. Schmunk</a>
&mdash;
NASA Official:
<a href="https://www.giss.nasa.gov/staff/gschmidt.html">
Gavin A. Schmidt</a></p>
<p><a href="https://www.giss.nasa.gov/about/contact.html">Contact GISS</a> &mdash;
<a href="https://www.nasa.gov/about/highlights/HP_Privacy.html">NASA Privacy Policy</a> &mdash;
<a href="https://www.nasa.gov/general/accessibility/">Accessibility</a></p></div><!-- end footerinfo --></div><!-- end footer --></div><!-- end page --></body>

</html>



 contentType 9 text/html url 52 https://www.giss.nasa.gov:443/staff/mmishchenko/brf/ responseCode 3 200 