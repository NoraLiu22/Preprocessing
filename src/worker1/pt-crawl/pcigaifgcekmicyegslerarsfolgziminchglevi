pcigaifgcekmicyegslerarsfolgziminchglevi length 5 18419 page 18419 <!DOCTYPE HTML><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" type="text/css" href="https://www.giss.nasa.gov/css/css2104.css" media="all" />


<title>NASA GISS: Scattering &mdash; T-Matrix Codes</title>
<link rel="apple-touch-icon" href="/gfx/apple-touch-icon-180x180.png" />
<link rel="apple-touch-icon-precomposed" href="/gfx/apple-touch-icon-180x180.png" />
<link rel="apple-touch-icon" sizes="192x192" href="/gfx/apple-touch-icon-192x192.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/gfx/apple-touch-icon-180x180.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/gfx/apple-touch-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="128x128" href="/gfx/apple-touch-icon-128x128.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/gfx/apple-touch-icon-76x76.png" />
<meta name="orgcode" content="611" />
<meta name="rno" content="Gavin.A.Schmidt.1" />
<meta name="content-owner" content="Robert.B.Schmunk.1" />
<meta name="webmaster" content="Robert.B.Schmunk.1" />
<meta name="viewport" content="width=956, initial-scale=1" /><script id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NASA&amp;subagency=GISS&amp;yt=true&amp;dclink=true&amp;pua=UA-52099626-1" async="async"></script>
</head>
<body>
<div id="bkg1"><div id="bkg2"></div><!-- end bkg2 --></div><!-- end bkg1 -->
<div id="page">
<div id="archive">
<p>This page's content is no longer actively maintained, but the material has been kept on-line for historical purposes.<br />The page may contain broken links or outdated information, and parts may not function in current web browsers.</p></div>
<div class="hidden">
<a href="#content" title="Go to Main Content" accesskey="2">Go to Main Content (Accesskey 2)</a><br /><a href="#nav" title="Go to Site Menu" accesskey="3">Go to Site Menu (Accesskey 3)</a></div><!-- end hidden -->
<div id="header">
<div id="headerlogo">
<a href="https://www.nasa.gov/"><img src="https://www.giss.nasa.gov/gfx/2013/nasa_x2.png" alt="NASA Logo, National Aeronautics and Space Administration" style="width:140px;height:98px" /></a></div><!-- end headerlogo -->
<div id="centername">
<h1><a href="https://www.nasa.gov/">National Aeronautics and Space Administration</a></h1>
<h2><a href="https://www.giss.nasa.gov/">Goddard Institute for Space Studies</a></h2></div><!-- end centername -->
<div id="hierarchy">
<h2><a href="https://www.nasa.gov/goddard/">Goddard Space Flight Center</a><br /><a href="https://science.gsfc.nasa.gov/sci">Sciences and Exploration Directorate</a><br /><a href="https://science.gsfc.nasa.gov/earth">Earth Sciences Division</a></h2></div><!-- end hierarchy --></div><!-- end header -->
<div id="paper">
<div id="content"><div id="cpad">


<h2>Electromagnetic Scattering by Particles and Surfaces</h2>

<h3><i>T</i>-Matrix Codes for Computing Electromagnetic Scattering by Nonspherical and Aggregated Particles</h3>









<p class="byline">By
Michael I. Mishchenko,
Larry D. Travis, and 
Daniel W. Mackowski</p>


<div class="floatright">
<img src="Peter_Waterman.jpg" style="width:200px;height:292px;margin-left:8px" alt="Photo of Peter Waterman" />
</div>


<p>
This webpage is dedicated to the creator of the <i>T</i>-matrix method, <b>Peter Waterman</b>. It provides free public access to
<i>T</i>-matrix codes for the computation of electromagnetic 
scattering by homogeneous, rotationally symmetric nonspherical particles in 
fixed and random orientations,  
a superposition <i>T</i>-matrix code for 
randomly oriented two-sphere clusters with touching or separated
components, and superposition <i>T</i>-matrix codes for multi-sphere
clusters in fixed and random orientations.  All codes are written in Fortran-77. 
Each code is extensively documented and provides all necessary references 
to relevant publications.
</p>

<p>
The double-precision and extended-precision versions of the 
regular <i>T</i>-matrix codes  
are essentially identical.  The extended-precision versions
are a factor of 5-8 slower than their double-precision equivalents, but
allow computations for larger (a factor of 2-3) particles. 
The extended-precision
codes have a more detailed documentation of all the subroutines used.
</p>

<p>
The regular <i>T</i>-matrix codes are applicable to 
rotationally symmetric particles with
equivalent-sphere size parameters exceeding 100.  At present, the
<i>T</i>-matrix method is the fastest exact technique for the computation of
nonspherical scattering based on a direct solution of Maxwell's equations.
The <i>T</i>-matrix codes are orders of magnitude faster than those based on the 
DDA, VIEF, and FDTD techniques.
</p>

<p>
The regular <i>T</i>-matrix codes for randomly oriented particles are based on the analytical
orientation averaging procedure described in the paper M. I. Mishchenko,
J. Opt. Soc. Am. A 8, 871-882 (1991).  This efficient procedure
makes the codes 1 to 2 orders of magnitude faster than <i>T</i>-matrix codes
based on the standard numerical averaging approach.  The superposition
bisphere and multi-sphere <i>T</i>-matrix codes are based on similar analytical approaches and are
described in the papers M. I. Mishchenko and D. W. Mackowski,
Opt. Lett., vol. 19, 1604-1606 (1994) and D. W. Mackowski and  M. I. Mishchenko, 
J. Opt. Soc. Amer. A., vol. 13, 2266-2278 (1996).  In application to bispheres, the multi-sphere
<i>T</i>-matrix code is slower than the bisphere code.  However, it can be applied to clusters with a number of
components larger than 2.
</p>




<div class="floatright">
<img src="butterfly.gif" style="width:250px;height:292px;border:0;margin-left:8px" alt="Sample scattering polarization plot" />
</div>


<p>
A general <b>review</b> of the Waterman's <i>T</i>-matrix method can be found in the paper
M. I. Mishchenko, L. D. Travis, and D. W. Mackowski,
<a href="https://pubs.giss.nasa.gov/abs/mi08700c.html">
T-matrix computations of light scattering by nonspherical particles: A review</a>,
<cite>J. Quant. Spectrosc. Radiat. Transfer</cite>, <b>55</b>, 535-575 (1996).
</p>

<p>
A detailed <b>user guide</b> to the regular random-orientation <i>T</i>-matrix codes
was also published as
<a href="https://pubs.giss.nasa.gov/abs/mi06100c.html">
Capabilities and limitations of a current FORTRAN implementation of the T-matrix method for randomly oriented, rotationally symmetric scatterers</a>,
[<cite>J. Quant. Spectrosc. Radiat. Transfer</cite>, <b>60</b>, 309-324 (1998)] .
</p>

<p>
A <b>user guide </b> to the <i>T</i>-matrix codes for nonspherical particles in a fixed orientation was published as
<a href="https://pubs.giss.nasa.gov/abs/mi04200b.html">
Calculation of the amplitude matrix for a nonspherical particle in a fixed orientation</a>
[<cite>Appl. Opt.</cite>, <b>39</b>, 1026-1031 (2000)].
</p>

<p>
A comprehensive account of light scattering, including a detailed description of
the <i>T</i>-matrix codes, can be found in the <b>book</b>
<a href="/staff/mmishchenko/books.html">
<cite>Scattering, Absorption, and Emission of Light by Small Particles</cite></a>,
Cambridge University Press, Cambridge (2002).
</p>

<p>
The users of the codes are encouraged to visit this page on a regular
basis for information on latest developments, warnings, and/or
errors found.  
</p>



<p>
To retrieve a code, right-click on the code name and use the "Save As..." option
from the menu.
</p>

<h4> New LAPACK-based <i>T</i>-matrix codes</h4>

<p>These codes are based on the LAPACK version of the LU-factorization
procedure, contain no proprietary components, and are equivalent
to the old NAG-based codes in terms of efficiency and 
performance. We thank Cory Davis (University of Edinburgh) for 
pointing out the possibility of replacing the proprietary NAG 
matrix inversion routine by the public-domain LAPACK equivalent. 
The extended-precision codes require a FORTRAN compiler supporting
REAL*16 and COMPLEX*32 variables, e.g., Intel Fortran Compiler version 
12.1.2 for Linux or Visual Fortran Intel(R) 64 Compiler XE version 
13.0.1 for WINDOWS-7(x64).  
 
<ul>
<li><b>Extended-precision</b> <i>T</i>-matrix code for
  <b>randomly</b> oriented nonspherical particles:
  <a href="/staff/mmishchenko/ftpcode/tmq.lp.f">tmq.lp.f</a>, 
  <a href="/staff/mmishchenko/ftpcode/lpq.f">lpq.f</a>,
  and 
  <a href="/staff/mmishchenko/ftpcode/tmq.par.f">tmq.par.f</a></li>
</ul>

<ul>
<li><b>Extended-precision</b> <i>T</i>-matrix code for
   nonspherical particles in a <b>fixed</b> orientation:
  <a href="/staff/mmishchenko/ftpcode/amplq.lp.f">amplq.lp.f</a>,  
  <a href="/staff/mmishchenko/ftpcode/lpq.f">lpq.f</a>,
  and 
  <a href="/staff/mmishchenko/ftpcode/amplq.par.f">amplq.par.f</a></li>
</ul>

<ul>

<li><b>Double-precision</b> <i>T</i>-matrix code for
  <b>randomly</b> oriented nonspherical particles:
  <a href="/staff/mmishchenko/ftpcode/tmd.lp.f">tmd.lp.f</a>,  
  <a href="/staff/mmishchenko/ftpcode/lpd.f">lpd.f</a>,
  and 
  <a href="/staff/mmishchenko/ftpcode/tmd.par.f">tmd.par.f</a></li>
</ul>

<ul>

<li><b>Double precision</b> <i>T</i>-matrix  code for
   nonspherical particles in a   <b>fixed</b> orientation:
  <a href="/staff/mmishchenko/ftpcode/ampld.lp.f">ampld.lp.f</a>, 
  <a href="/staff/mmishchenko/ftpcode/lpd.f">lpd.f</a>,
  and 
  <a href="/staff/mmishchenko/ftpcode/ampld.par.f">ampld.par.f</a></li>
</ul>

<h4> Old Gauss-elimination- and NAG-based <i>T</i>-matrix codes</h4>

<ul>
<li><b>Extended-precision</b> <i>T</i>-matrix code for
  <b>randomly</b> oriented nonspherical particles:
  <a href="/staff/mmishchenko/ftpcode/tmq.new.f">tmq.new.f</a>
  and 
  <a href="/staff/mmishchenko/ftpcode/tmq.par.f">tmq.par.f</a></li>
</ul>

<ul>
<li><b>Extended-precision</b> <i>T</i>-matrix code for
   nonspherical particles in a   <b>fixed</b> orientation:
  <a href="/staff/mmishchenko/ftpcode/amplq.new.f">amplq.new.f</a> 
  and 
  <a href="/staff/mmishchenko/ftpcode/amplq.par.f">amplq.par.f</a></li>
</ul>

<ul>

<li><b>Double-precision</b> <i>T</i>-matrix code for
  <b>randomly</b> oriented nonspherical particles:
  <a href="/staff/mmishchenko/ftpcode/tmd.new.f">tmd.new.f</a> 
  and 
  <a href="/staff/mmishchenko/ftpcode/tmd.par.f">tmd.par.f</a></li>
</ul>

<ul>

<li><b>Double-precision</b> <i>T</i>-matrix  code for
   nonspherical particles in a   <b>fixed</b> orientation:
  <a href="/staff/mmishchenko/ftpcode/ampld.new.f">ampld.new.f</a>
  and 
  <a href="/staff/mmishchenko/ftpcode/ampld.par.f">ampld.par.f</a></li>
</ul>


<h4> Superposition <i>T</i>-matrix codes</h4>

<ul>
<li>Double-precision superposition <i>T</i>-matrix  code for
   randomly oriented two-sphere clusters with externally touching or separated components: 
  <a href="/staff/mmishchenko/ftpcode/bisphere.f">bisphere.f</a></li>
</ul>

<ul>
<li><a href="ftp://ftp.eng.auburn.edu/pub/dmckwski/scatcodes/">
   Double-precision superposition codes for externally aggregated
   multi-sphere clusters in fixed and random orientations</a></li>
</ul>

<ul>
<li>New <a href="http://eng.auburn.edu/users/dmckwski/scatcodes"> parallelized double-precision
   <i>T</i>-matrix Fortran code</a>
   for multi-sphere clusters with separated, externally touching, and/or nested components.
   <a href="STM_manual.pdf">Download the PDF</a> of the corresponding JQSRT papers serving as user guides.
</li>
</ul>

<p><b>Double-precision Lorenz-Mie scattering code</b> for polydisperse spherical particles:
<a href="/staff/mmishchenko/ftpcode/spher.f">spher.f</a>
</p>

<p><b>Codes for the computation of the coefficients for the generalized Chebyshev shape</b>
by interpolating the values given in Table 1 of Chuang and Beard (1990):
  <a href="modified_double_precision_drop.f">modified_double_precision_drop.f</a>,
  <a href="modified_extended_precision_drop.f">modified_extended_precision_drop.f</a>,
developed by <a href="mailto:Hidde.Leijnse@wur.nl">Dr. Hidde Leijnse</a>
</p>






















<p class="ednote">
PDF documents linked on these scattering pages
may be viewed using Adobe's free
<a href="http://www.adobe.com/products/acrobat/readstep.html">Acrobat Reader</a>.
</p>





<p style="padding: 8px; margin-top: 12px; border: solid #009 1px; text-align: center">

  <b><a href="/staff/mmishchenko/">Michael Mishchenko</a></b>
  <br />
  <a href="/staff/mmishchenko/publications/">Publications On-Line</a> &#124;
  <a href="/staff/mmishchenko/books/">Books</a> &#124;
  <a href="/staff/mmishchenko/tmatrix/"><i>T</i>-Matrix Database</a>
  <br />
  Codes: <a href="/staff/mmishchenko/tmatrix/"><i>T</i>-Matrix</a> &#124;
  <a href="/staff/mmishchenko/brf/">Bidirectional Reflectance</a> &#124;
  <a href="/staff/mmishchenko/Lorenz-Mie.html">Lorenz-Mie</a>

</p>



















<div class="clear"></div></div><!-- end cpad --></div><!-- end content -->
<div id="nav"><h3>Site Menu</h3>
<ul id="mnav">
<li><a href="https://www.giss.nasa.gov/">GISS Home</a></li>
<li><a href="https://www.giss.nasa.gov/research/">News &amp; Features</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/research/">News &amp; Features Overview</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/projects/">Projects &amp; Groups</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/projects/">Projects Overview</a></li>
<li><a href="https://www.giss.nasa.gov/projects/gcm/">Global Climate Modeling</a></li>
<li><a href="https://www.giss.nasa.gov/projects/astrobio/">Astrobiology / ROCKE-3D</a></li>
<li><a href="https://www.giss.nasa.gov/projects/impacts/">Climate Impacts</a></li>
<li><a href="https://isccp.giss.nasa.gov/">ISCCP</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://data.giss.nasa.gov/">Datasets</a>
<ul class="mnav2">
<li><a href="https://data.giss.nasa.gov/">Datasets Overview</a></li>
<li><a href="https://data.giss.nasa.gov/gistemp/">GISTEMP Surface Temperature</a></li>
<li><a href="https://data.giss.nasa.gov/modelE/">Model E Simulations</a></li>
<li><a href="https://data.giss.nasa.gov/modelforce/">Model Forcings</a></li>
<li><a href="https://data.giss.nasa.gov/rocke3d/maps/">ROCKE-3D Simulations</a></li>
<li><a href="https://isccp.giss.nasa.gov/products/onlineData.html">ISCCP Data Products</a></li>
<li><a href="https://gacp.giss.nasa.gov/datasets/">GACP Data Products</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://pubs.giss.nasa.gov/">Publications</a>
<ul class="mnav2">
<li><a href="https://pubs.giss.nasa.gov/">Publications Overview</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2024.html">2024 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2023.html">2023 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2022.html">2022 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2021.html">2021 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/2020.html">2020 Publications</a></li>
<li><a href="https://pubs.giss.nasa.gov/year/inpress.html">Accepted &amp; In Press</a></li>
<li><a href="https://pubs.giss.nasa.gov/authors/">Author Bibliographies</a></li>
<li><a href="https://pubs.giss.nasa.gov/best.html">Annual Best</a></li>
<li><a href="https://pubs.giss.nasa.gov/cited.html">Most Cited</a></li>
<li><a href="https://pubs.giss.nasa.gov/dissertations.html">Dissertations</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/tools/">Software</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/tools/">Software Overview</a></li>
<li><a href="https://www.giss.nasa.gov/tools/modelE/">GCM Model E</a></li>
<li><a href="https://www.giss.nasa.gov/tools/panoply/">Panoply Data Viewer</a></li>
<li><a href="https://www.giss.nasa.gov/tools/gprojector/">G.Projector</a></li>
<li><a href="https://www.giss.nasa.gov/tools/mars24/">Mars24 Sunclock</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/edu/">Education</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/edu/">Education Overview</a></li>
<li><a href="https://www.giss.nasa.gov/edu/intern/">Internships</a></li>
<li><a href="https://www.giss.nasa.gov/edu/ccri/">CCRI</a></li>
<li><a href="https://www.giss.nasa.gov/edu/grad/">Graduate Study</a></li>
<li><a href="https://www.giss.nasa.gov/about/jobs/postdoc.html">Postdoc Research</a></li>
<li><a href="https://www.giss.nasa.gov/edu/res/">STEM Curriculum Modules</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/events/">Events</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/events/">Events Overview</a></li>
<li><a href="https://www.giss.nasa.gov/events/lunch/">Lunch Seminars</a></li>
<li><a href="https://www.giss.nasa.gov/events/past.html">Past Events</a></li></ul><!-- end mnav2 --></li>
<li><a href="https://www.giss.nasa.gov/about/">About GISS</a>
<ul class="mnav2">
<li><a href="https://www.giss.nasa.gov/about/">About GISS</a></li>
<li><a href="https://www.giss.nasa.gov/about/management.html">Management Staff</a></li>
<li><a href="https://www.giss.nasa.gov/staff/">Personnel Directory</a></li>
<li><a href="https://www.giss.nasa.gov/about/visiting/">Visitors' Info</a></li>
<li><a href="https://www.giss.nasa.gov/about/jobs/">Employment</a></li></ul><!-- end mnav2 --></li></ul><!-- end mnav --></div><!-- end nav -->

<div id="endpaper"></div></div><!-- end paper -->
<div id="footer">
<div id="footerlogo">
<a href="https://www.nasa.gov"><img src="https://www.giss.nasa.gov/gfx/2013/nasa_x2.png" alt="NASA Logo, National Aeronautics and Space Administration" style="width:140px;height:98px" /></a></div><!-- end footerlogo -->
<div id="footersig"><a href="https://www.nasa.gov/goddard/" class="imageLink"><img src="https://www.giss.nasa.gov/gfx/2013/gsig.png" alt="Goddard Space Flight Center" style="width:172px;height:68px" /></a></div><!-- end footersig -->
<div id="footerinfo">
<p>Page updated: Jul 15, 2023</p>
<p>Website Curator:
<a href="https://www.giss.nasa.gov/staff/rschmunk.html">
Robert B. Schmunk</a>
&mdash;
NASA Official:
<a href="https://www.giss.nasa.gov/staff/gschmidt.html">
Gavin A. Schmidt</a></p>
<p><a href="https://www.giss.nasa.gov/about/contact.html">Contact GISS</a> &mdash;
<a href="https://www.nasa.gov/about/highlights/HP_Privacy.html">NASA Privacy Policy</a> &mdash;
<a href="https://www.nasa.gov/general/accessibility/">Accessibility</a></p></div><!-- end footerinfo --></div><!-- end footer --></div><!-- end page --></body>

</html>


 contentType 9 text/html url 56 https://www.giss.nasa.gov:443/staff/mmishchenko/tmatrix/ responseCode 3 200 