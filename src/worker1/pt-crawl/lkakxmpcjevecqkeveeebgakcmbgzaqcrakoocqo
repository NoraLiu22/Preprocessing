lkakxmpcjevecqkeveeebgakcmbgzaqcrakoocqo length 5 37849 page 37849 
<html>
<head>
<title>r94680 MediaWiki - Code Review archive</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../ext.codereview.styles.css"/>
</head>
<body>
<h1>r94680 MediaWiki - Code Review archive</h1>
<div id="mw-content-text" class="mw-body-content"><form action="/wiki/Special:Code/MediaWiki/94680" method="post"><table class="mw-codereview-meta"><tr><td>Repository:</td><td><a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki" title="Special:Code/MediaWiki">MediaWiki</a></td></tr>
<tr><td>Revision:</td><td>&lt;&#160;<a href="./94679.html" title="Special:Code/MediaWiki/94679">r94679</a>‎ | <b>r94680</b> | <a href="./94681.html" title="Special:Code/MediaWiki/94681">r94681</a>&#160;&gt;</td></tr>
<tr><td>Date:</td><td>19:29, 16 August 2011</td></tr>
<tr><td>Author:</td><td><a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/author/robin" title="Special:Code/MediaWiki/author/robin">robin</a></td></tr>
<tr><td>Status:</td><td>resolved (<a href="#code-comments">Comments</a>)
</td></tr>
<tr><td>Tags:</td><td></td></tr>
<tr><td>Comment:</td><td><div class="mw-codereview-message">Magic words (time and number-formatting ones, plus DIRECTIONMARK, but not NAMESPACE) now depend on the page content language instead of the site language. In theory this sets the right magic words in system messages, although they are not used there.<br />
Useful for multilingual wikis like Incubator, and probably for extensions like Translate.</div></td></tr>
<tr><td>Modified paths:</td><td><div class='mw-codereview-paths mw-content-ltr'><ul>
<li><b>/trunk/phase3/RELEASE-NOTES-1.19</b> (modified) (<a href="https://www.mediawiki.org/w/index.php?title=Special:Code/MediaWiki&amp;path=%2Ftrunk%2Fphase3%2FRELEASE-NOTES-1.19" title="Special:Code/MediaWiki">history</a>)</li>
<li><b>/trunk/phase3/includes/parser/Parser.php</b> (modified) (<a href="https://www.mediawiki.org/w/index.php?title=Special:Code/MediaWiki&amp;path=%2Ftrunk%2Fphase3%2Fincludes%2Fparser%2FParser.php" title="Special:Code/MediaWiki">history</a>)</li>
</ul></div>
</td></tr>
</table>
<h2>Diff <small>[<a href="https://www.mediawiki.org/w/index.php?title=Special:Code/MediaWiki/94680&amp;action=purge" title="Special:Code/MediaWiki/94680">purge</a>]</small></h2><div class='mw-codereview-diff' id='mw-codereview-diff'><table class="mw-codereview-diff"><tr id="1" class="patchedfile"><td colspan="3">Index: trunk/phase3/RELEASE-NOTES-1.19</td></tr>



<tr id="5"><td class="linenumbers">—</td><td class="linenumbers">—</td><td class="chunkdelimiter"><span>@@ -36,6 +36,9 @@</span></td></tr>
<tr id="6"><td class="linenumbers">37</td><td class="linenumbers">37</td><td class="unchanged"><span> * Most presentational html attributes like valign are now converted to inline</span></td></tr>
<tr id="7"><td class="linenumbers">38</td><td class="linenumbers">38</td><td class="unchanged"><span>   css style rules. These attributes were removed from html5 and so we clean them up</span></td></tr>
<tr id="8"><td class="linenumbers">39</td><td class="linenumbers">39</td><td class="unchanged"><span>   when $wgHtml5 is enabled. This can be disabled using $wgCleanupPresentationalAttributes. </span></td></tr>
<tr id="9"><td class="linenumbers"> </td><td class="linenumbers">40</td><td class="ins"><ins>+* Magic words (time and number-formatting ones, plus DIRECTIONMARK, but not NAMESPACE)</ins></td></tr>
<tr id="10"><td class="linenumbers"> </td><td class="linenumbers">41</td><td class="ins"><ins>+  now depend on the page content language instead of the site language. In theory</ins></td></tr>
<tr id="11"><td class="linenumbers"> </td><td class="linenumbers">42</td><td class="ins"><ins>+  this sets the right magic words in system messages, although they are not used there.</ins></td></tr>
<tr id="12"><td class="linenumbers">40</td><td class="linenumbers">43</td><td class="unchanged"><span> </span></td></tr>
<tr id="13"><td class="linenumbers">41</td><td class="linenumbers">44</td><td class="unchanged"><span> === Bug fixes in 1.19 ===</span></td></tr>
<tr id="14"><td class="linenumbers">42</td><td class="linenumbers">45</td><td class="unchanged"><span> * $wgUploadNavigationUrl should be used for file redlinks if</span></td></tr>
<tr id="15" class="patchedfile"><td colspan="3">Index: trunk/phase3/includes/parser/Parser.php</td></tr>



<tr id="19"><td class="linenumbers">—</td><td class="linenumbers">—</td><td class="chunkdelimiter"><span>@@ -2694,48 +2694,50 @@</span></td></tr>
<tr id="20"><td class="linenumbers">2695</td><td class="linenumbers">2695</td><td class="unchanged"><span> 			date_default_timezone_set( $oldtz );</span></td></tr>
<tr id="21"><td class="linenumbers">2696</td><td class="linenumbers">2696</td><td class="unchanged"><span> 		}</span></td></tr>
<tr id="22"><td class="linenumbers">2697</td><td class="linenumbers">2697</td><td class="unchanged"><span> </span></td></tr>
<tr id="23"><td class="linenumbers"> </td><td class="linenumbers">2698</td><td class="ins"><ins>+		$pageLang = $this->getFunctionLang();</ins></td></tr>
<tr id="24"><td class="linenumbers"> </td><td class="linenumbers">2699</td><td class="ins"><ins>+</ins></td></tr>
<tr id="25"><td class="linenumbers">2698</td><td class="linenumbers">2700</td><td class="unchanged"><span> 		switch ( $index ) {</span></td></tr>
<tr id="26"><td class="linenumbers">2699</td><td class="linenumbers">2701</td><td class="unchanged"><span> 			case 'currentmonth':</span></td></tr>
<tr id="27"><td class="linenumbers">2700</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( gmdate( 'm', $ts ) );</del></td></tr>
<tr id="28"><td class="linenumbers"> </td><td class="linenumbers">2702</td><td class="ins"><ins>+				$value = $pageLang->formatNum( gmdate( 'm', $ts ) );</ins></td></tr>
<tr id="29"><td class="linenumbers">2701</td><td class="linenumbers">2703</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="30"><td class="linenumbers">2702</td><td class="linenumbers">2704</td><td class="unchanged"><span> 			case 'currentmonth1':</span></td></tr>
<tr id="31"><td class="linenumbers">2703</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( gmdate( 'n', $ts ) );</del></td></tr>
<tr id="32"><td class="linenumbers"> </td><td class="linenumbers">2705</td><td class="ins"><ins>+				$value = $pageLang->formatNum( gmdate( 'n', $ts ) );</ins></td></tr>
<tr id="33"><td class="linenumbers">2704</td><td class="linenumbers">2706</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="34"><td class="linenumbers">2705</td><td class="linenumbers">2707</td><td class="unchanged"><span> 			case 'currentmonthname':</span></td></tr>
<tr id="35"><td class="linenumbers">2706</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getMonthName( gmdate( 'n', $ts ) );</del></td></tr>
<tr id="36"><td class="linenumbers"> </td><td class="linenumbers">2708</td><td class="ins"><ins>+				$value = $pageLang->getMonthName( gmdate( 'n', $ts ) );</ins></td></tr>
<tr id="37"><td class="linenumbers">2707</td><td class="linenumbers">2709</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="38"><td class="linenumbers">2708</td><td class="linenumbers">2710</td><td class="unchanged"><span> 			case 'currentmonthnamegen':</span></td></tr>
<tr id="39"><td class="linenumbers">2709</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getMonthNameGen( gmdate( 'n', $ts ) );</del></td></tr>
<tr id="40"><td class="linenumbers"> </td><td class="linenumbers">2711</td><td class="ins"><ins>+				$value = $pageLang->getMonthNameGen( gmdate( 'n', $ts ) );</ins></td></tr>
<tr id="41"><td class="linenumbers">2710</td><td class="linenumbers">2712</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="42"><td class="linenumbers">2711</td><td class="linenumbers">2713</td><td class="unchanged"><span> 			case 'currentmonthabbrev':</span></td></tr>
<tr id="43"><td class="linenumbers">2712</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getMonthAbbreviation( gmdate( 'n', $ts ) );</del></td></tr>
<tr id="44"><td class="linenumbers"> </td><td class="linenumbers">2714</td><td class="ins"><ins>+				$value = $pageLang->getMonthAbbreviation( gmdate( 'n', $ts ) );</ins></td></tr>
<tr id="45"><td class="linenumbers">2713</td><td class="linenumbers">2715</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="46"><td class="linenumbers">2714</td><td class="linenumbers">2716</td><td class="unchanged"><span> 			case 'currentday':</span></td></tr>
<tr id="47"><td class="linenumbers">2715</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( gmdate( 'j', $ts ) );</del></td></tr>
<tr id="48"><td class="linenumbers"> </td><td class="linenumbers">2717</td><td class="ins"><ins>+				$value = $pageLang->formatNum( gmdate( 'j', $ts ) );</ins></td></tr>
<tr id="49"><td class="linenumbers">2716</td><td class="linenumbers">2718</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="50"><td class="linenumbers">2717</td><td class="linenumbers">2719</td><td class="unchanged"><span> 			case 'currentday2':</span></td></tr>
<tr id="51"><td class="linenumbers">2718</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( gmdate( 'd', $ts ) );</del></td></tr>
<tr id="52"><td class="linenumbers"> </td><td class="linenumbers">2720</td><td class="ins"><ins>+				$value = $pageLang->formatNum( gmdate( 'd', $ts ) );</ins></td></tr>
<tr id="53"><td class="linenumbers">2719</td><td class="linenumbers">2721</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="54"><td class="linenumbers">2720</td><td class="linenumbers">2722</td><td class="unchanged"><span> 			case 'localmonth':</span></td></tr>
<tr id="55"><td class="linenumbers">2721</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( $localMonth );</del></td></tr>
<tr id="56"><td class="linenumbers"> </td><td class="linenumbers">2723</td><td class="ins"><ins>+				$value = $pageLang->formatNum( $localMonth );</ins></td></tr>
<tr id="57"><td class="linenumbers">2722</td><td class="linenumbers">2724</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="58"><td class="linenumbers">2723</td><td class="linenumbers">2725</td><td class="unchanged"><span> 			case 'localmonth1':</span></td></tr>
<tr id="59"><td class="linenumbers">2724</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( $localMonth1 );</del></td></tr>
<tr id="60"><td class="linenumbers"> </td><td class="linenumbers">2726</td><td class="ins"><ins>+				$value = $pageLang->formatNum( $localMonth1 );</ins></td></tr>
<tr id="61"><td class="linenumbers">2725</td><td class="linenumbers">2727</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="62"><td class="linenumbers">2726</td><td class="linenumbers">2728</td><td class="unchanged"><span> 			case 'localmonthname':</span></td></tr>
<tr id="63"><td class="linenumbers">2727</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getMonthName( $localMonthName );</del></td></tr>
<tr id="64"><td class="linenumbers"> </td><td class="linenumbers">2729</td><td class="ins"><ins>+				$value = $pageLang->getMonthName( $localMonthName );</ins></td></tr>
<tr id="65"><td class="linenumbers">2728</td><td class="linenumbers">2730</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="66"><td class="linenumbers">2729</td><td class="linenumbers">2731</td><td class="unchanged"><span> 			case 'localmonthnamegen':</span></td></tr>
<tr id="67"><td class="linenumbers">2730</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getMonthNameGen( $localMonthName );</del></td></tr>
<tr id="68"><td class="linenumbers"> </td><td class="linenumbers">2732</td><td class="ins"><ins>+				$value = $pageLang->getMonthNameGen( $localMonthName );</ins></td></tr>
<tr id="69"><td class="linenumbers">2731</td><td class="linenumbers">2733</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="70"><td class="linenumbers">2732</td><td class="linenumbers">2734</td><td class="unchanged"><span> 			case 'localmonthabbrev':</span></td></tr>
<tr id="71"><td class="linenumbers">2733</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getMonthAbbreviation( $localMonthName );</del></td></tr>
<tr id="72"><td class="linenumbers"> </td><td class="linenumbers">2735</td><td class="ins"><ins>+				$value = $pageLang->getMonthAbbreviation( $localMonthName );</ins></td></tr>
<tr id="73"><td class="linenumbers">2734</td><td class="linenumbers">2736</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="74"><td class="linenumbers">2735</td><td class="linenumbers">2737</td><td class="unchanged"><span> 			case 'localday':</span></td></tr>
<tr id="75"><td class="linenumbers">2736</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( $localDay );</del></td></tr>
<tr id="76"><td class="linenumbers"> </td><td class="linenumbers">2738</td><td class="ins"><ins>+				$value = $pageLang->formatNum( $localDay );</ins></td></tr>
<tr id="77"><td class="linenumbers">2737</td><td class="linenumbers">2739</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="78"><td class="linenumbers">2738</td><td class="linenumbers">2740</td><td class="unchanged"><span> 			case 'localday2':</span></td></tr>
<tr id="79"><td class="linenumbers">2739</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( $localDay2 );</del></td></tr>
<tr id="80"><td class="linenumbers"> </td><td class="linenumbers">2741</td><td class="ins"><ins>+				$value = $pageLang->formatNum( $localDay2 );</ins></td></tr>
<tr id="81"><td class="linenumbers">2740</td><td class="linenumbers">2742</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="82"><td class="linenumbers">2741</td><td class="linenumbers">2743</td><td class="unchanged"><span> 			case 'pagename':</span></td></tr>
<tr id="83"><td class="linenumbers">2742</td><td class="linenumbers">2744</td><td class="unchanged"><span> 				$value = wfEscapeWikiText( $this->mTitle->getText() );</span></td></tr>
<tr id="84"><td class="linenumbers">—</td><td class="linenumbers">—</td><td class="chunkdelimiter"><span>@@ -2860,68 +2862,68 @@</span></td></tr>
<tr id="85"><td class="linenumbers">2861</td><td class="linenumbers">2863</td><td class="unchanged"><span> 				$value = ( wfUrlencode( $this->mTitle->getSubjectNsText() ) );</span></td></tr>
<tr id="86"><td class="linenumbers">2862</td><td class="linenumbers">2864</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="87"><td class="linenumbers">2863</td><td class="linenumbers">2865</td><td class="unchanged"><span> 			case 'currentdayname':</span></td></tr>
<tr id="88"><td class="linenumbers">2864</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getWeekdayName( gmdate( 'w', $ts ) + 1 );</del></td></tr>
<tr id="89"><td class="linenumbers"> </td><td class="linenumbers">2866</td><td class="ins"><ins>+				$value = $pageLang->getWeekdayName( gmdate( 'w', $ts ) + 1 );</ins></td></tr>
<tr id="90"><td class="linenumbers">2865</td><td class="linenumbers">2867</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="91"><td class="linenumbers">2866</td><td class="linenumbers">2868</td><td class="unchanged"><span> 			case 'currentyear':</span></td></tr>
<tr id="92"><td class="linenumbers">2867</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( gmdate( 'Y', $ts ), true );</del></td></tr>
<tr id="93"><td class="linenumbers"> </td><td class="linenumbers">2869</td><td class="ins"><ins>+				$value = $pageLang->formatNum( gmdate( 'Y', $ts ), true );</ins></td></tr>
<tr id="94"><td class="linenumbers">2868</td><td class="linenumbers">2870</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="95"><td class="linenumbers">2869</td><td class="linenumbers">2871</td><td class="unchanged"><span> 			case 'currenttime':</span></td></tr>
<tr id="96"><td class="linenumbers">2870</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->time( wfTimestamp( TS_MW, $ts ), false, false );</del></td></tr>
<tr id="97"><td class="linenumbers"> </td><td class="linenumbers">2872</td><td class="ins"><ins>+				$value = $pageLang->time( wfTimestamp( TS_MW, $ts ), false, false );</ins></td></tr>
<tr id="98"><td class="linenumbers">2871</td><td class="linenumbers">2873</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="99"><td class="linenumbers">2872</td><td class="linenumbers">2874</td><td class="unchanged"><span> 			case 'currenthour':</span></td></tr>
<tr id="100"><td class="linenumbers">2873</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( gmdate( 'H', $ts ), true );</del></td></tr>
<tr id="101"><td class="linenumbers"> </td><td class="linenumbers">2875</td><td class="ins"><ins>+				$value = $pageLang->formatNum( gmdate( 'H', $ts ), true );</ins></td></tr>
<tr id="102"><td class="linenumbers">2874</td><td class="linenumbers">2876</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="103"><td class="linenumbers">2875</td><td class="linenumbers">2877</td><td class="unchanged"><span> 			case 'currentweek':</span></td></tr>
<tr id="104"><td class="linenumbers">2876</td><td class="linenumbers">2878</td><td class="unchanged"><span> 				# @bug 4594 PHP5 has it zero padded, PHP4 does not, cast to</span></td></tr>
<tr id="105"><td class="linenumbers">2877</td><td class="linenumbers">2879</td><td class="unchanged"><span> 				# int to remove the padding</span></td></tr>
<tr id="106"><td class="linenumbers">2878</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( (int)gmdate( 'W', $ts ) );</del></td></tr>
<tr id="107"><td class="linenumbers"> </td><td class="linenumbers">2880</td><td class="ins"><ins>+				$value = $pageLang->formatNum( (int)gmdate( 'W', $ts ) );</ins></td></tr>
<tr id="108"><td class="linenumbers">2879</td><td class="linenumbers">2881</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="109"><td class="linenumbers">2880</td><td class="linenumbers">2882</td><td class="unchanged"><span> 			case 'currentdow':</span></td></tr>
<tr id="110"><td class="linenumbers">2881</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( gmdate( 'w', $ts ) );</del></td></tr>
<tr id="111"><td class="linenumbers"> </td><td class="linenumbers">2883</td><td class="ins"><ins>+				$value = $pageLang->formatNum( gmdate( 'w', $ts ) );</ins></td></tr>
<tr id="112"><td class="linenumbers">2882</td><td class="linenumbers">2884</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="113"><td class="linenumbers">2883</td><td class="linenumbers">2885</td><td class="unchanged"><span> 			case 'localdayname':</span></td></tr>
<tr id="114"><td class="linenumbers">2884</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->getWeekdayName( $localDayOfWeek + 1 );</del></td></tr>
<tr id="115"><td class="linenumbers"> </td><td class="linenumbers">2886</td><td class="ins"><ins>+				$value = $pageLang->getWeekdayName( $localDayOfWeek + 1 );</ins></td></tr>
<tr id="116"><td class="linenumbers">2885</td><td class="linenumbers">2887</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="117"><td class="linenumbers">2886</td><td class="linenumbers">2888</td><td class="unchanged"><span> 			case 'localyear':</span></td></tr>
<tr id="118"><td class="linenumbers">2887</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( $localYear, true );</del></td></tr>
<tr id="119"><td class="linenumbers"> </td><td class="linenumbers">2889</td><td class="ins"><ins>+				$value = $pageLang->formatNum( $localYear, true );</ins></td></tr>
<tr id="120"><td class="linenumbers">2888</td><td class="linenumbers">2890</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="121"><td class="linenumbers">2889</td><td class="linenumbers">2891</td><td class="unchanged"><span> 			case 'localtime':</span></td></tr>
<tr id="122"><td class="linenumbers">2890</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->time( $localTimestamp, false, false );</del></td></tr>
<tr id="123"><td class="linenumbers"> </td><td class="linenumbers">2892</td><td class="ins"><ins>+				$value = $pageLang->time( $localTimestamp, false, false );</ins></td></tr>
<tr id="124"><td class="linenumbers">2891</td><td class="linenumbers">2893</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="125"><td class="linenumbers">2892</td><td class="linenumbers">2894</td><td class="unchanged"><span> 			case 'localhour':</span></td></tr>
<tr id="126"><td class="linenumbers">2893</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( $localHour, true );</del></td></tr>
<tr id="127"><td class="linenumbers"> </td><td class="linenumbers">2895</td><td class="ins"><ins>+				$value = $pageLang->formatNum( $localHour, true );</ins></td></tr>
<tr id="128"><td class="linenumbers">2894</td><td class="linenumbers">2896</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="129"><td class="linenumbers">2895</td><td class="linenumbers">2897</td><td class="unchanged"><span> 			case 'localweek':</span></td></tr>
<tr id="130"><td class="linenumbers">2896</td><td class="linenumbers">2898</td><td class="unchanged"><span> 				# @bug 4594 PHP5 has it zero padded, PHP4 does not, cast to</span></td></tr>
<tr id="131"><td class="linenumbers">2897</td><td class="linenumbers">2899</td><td class="unchanged"><span> 				# int to remove the padding</span></td></tr>
<tr id="132"><td class="linenumbers">2898</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( (int)$localWeek );</del></td></tr>
<tr id="133"><td class="linenumbers"> </td><td class="linenumbers">2900</td><td class="ins"><ins>+				$value = $pageLang->formatNum( (int)$localWeek );</ins></td></tr>
<tr id="134"><td class="linenumbers">2899</td><td class="linenumbers">2901</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="135"><td class="linenumbers">2900</td><td class="linenumbers">2902</td><td class="unchanged"><span> 			case 'localdow':</span></td></tr>
<tr id="136"><td class="linenumbers">2901</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( $localDayOfWeek );</del></td></tr>
<tr id="137"><td class="linenumbers"> </td><td class="linenumbers">2903</td><td class="ins"><ins>+				$value = $pageLang->formatNum( $localDayOfWeek );</ins></td></tr>
<tr id="138"><td class="linenumbers">2902</td><td class="linenumbers">2904</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="139"><td class="linenumbers">2903</td><td class="linenumbers">2905</td><td class="unchanged"><span> 			case 'numberofarticles':</span></td></tr>
<tr id="140"><td class="linenumbers">2904</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::articles() );</del></td></tr>
<tr id="141"><td class="linenumbers"> </td><td class="linenumbers">2906</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::articles() );</ins></td></tr>
<tr id="142"><td class="linenumbers">2905</td><td class="linenumbers">2907</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="143"><td class="linenumbers">2906</td><td class="linenumbers">2908</td><td class="unchanged"><span> 			case 'numberoffiles':</span></td></tr>
<tr id="144"><td class="linenumbers">2907</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::images() );</del></td></tr>
<tr id="145"><td class="linenumbers"> </td><td class="linenumbers">2909</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::images() );</ins></td></tr>
<tr id="146"><td class="linenumbers">2908</td><td class="linenumbers">2910</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="147"><td class="linenumbers">2909</td><td class="linenumbers">2911</td><td class="unchanged"><span> 			case 'numberofusers':</span></td></tr>
<tr id="148"><td class="linenumbers">2910</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::users() );</del></td></tr>
<tr id="149"><td class="linenumbers"> </td><td class="linenumbers">2912</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::users() );</ins></td></tr>
<tr id="150"><td class="linenumbers">2911</td><td class="linenumbers">2913</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="151"><td class="linenumbers">2912</td><td class="linenumbers">2914</td><td class="unchanged"><span> 			case 'numberofactiveusers':</span></td></tr>
<tr id="152"><td class="linenumbers">2913</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::activeUsers() );</del></td></tr>
<tr id="153"><td class="linenumbers"> </td><td class="linenumbers">2915</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::activeUsers() );</ins></td></tr>
<tr id="154"><td class="linenumbers">2914</td><td class="linenumbers">2916</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="155"><td class="linenumbers">2915</td><td class="linenumbers">2917</td><td class="unchanged"><span> 			case 'numberofpages':</span></td></tr>
<tr id="156"><td class="linenumbers">2916</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::pages() );</del></td></tr>
<tr id="157"><td class="linenumbers"> </td><td class="linenumbers">2918</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::pages() );</ins></td></tr>
<tr id="158"><td class="linenumbers">2917</td><td class="linenumbers">2919</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="159"><td class="linenumbers">2918</td><td class="linenumbers">2920</td><td class="unchanged"><span> 			case 'numberofadmins':</span></td></tr>
<tr id="160"><td class="linenumbers">2919</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::numberingroup( 'sysop' ) );</del></td></tr>
<tr id="161"><td class="linenumbers"> </td><td class="linenumbers">2921</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::numberingroup( 'sysop' ) );</ins></td></tr>
<tr id="162"><td class="linenumbers">2920</td><td class="linenumbers">2922</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="163"><td class="linenumbers">2921</td><td class="linenumbers">2923</td><td class="unchanged"><span> 			case 'numberofedits':</span></td></tr>
<tr id="164"><td class="linenumbers">2922</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::edits() );</del></td></tr>
<tr id="165"><td class="linenumbers"> </td><td class="linenumbers">2924</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::edits() );</ins></td></tr>
<tr id="166"><td class="linenumbers">2923</td><td class="linenumbers">2925</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="167"><td class="linenumbers">2924</td><td class="linenumbers">2926</td><td class="unchanged"><span> 			case 'numberofviews':</span></td></tr>
<tr id="168"><td class="linenumbers">2925</td><td class="linenumbers"> </td><td class="del"><del>-				$value = $wgContLang->formatNum( SiteStats::views() );</del></td></tr>
<tr id="169"><td class="linenumbers"> </td><td class="linenumbers">2927</td><td class="ins"><ins>+				$value = $pageLang->formatNum( SiteStats::views() );</ins></td></tr>
<tr id="170"><td class="linenumbers">2926</td><td class="linenumbers">2928</td><td class="unchanged"><span> 				break;</span></td></tr>
<tr id="171"><td class="linenumbers">2927</td><td class="linenumbers">2929</td><td class="unchanged"><span> 			case 'currenttimestamp':</span></td></tr>
<tr id="172"><td class="linenumbers">2928</td><td class="linenumbers">2930</td><td class="unchanged"><span> 				$value = wfTimestamp( TS_MW, $ts );</span></td></tr>
<tr id="173"><td class="linenumbers">—</td><td class="linenumbers">—</td><td class="chunkdelimiter"><span>@@ -2948,7 +2950,7 @@</span></td></tr>
<tr id="174"><td class="linenumbers">2949</td><td class="linenumbers">2951</td><td class="unchanged"><span> 			case 'stylepath':</span></td></tr>
<tr id="175"><td class="linenumbers">2950</td><td class="linenumbers">2952</td><td class="unchanged"><span> 				return $wgStylePath;</span></td></tr>
<tr id="176"><td class="linenumbers">2951</td><td class="linenumbers">2953</td><td class="unchanged"><span> 			case 'directionmark':</span></td></tr>
<tr id="177"><td class="linenumbers">2952</td><td class="linenumbers"> </td><td class="del"><del>-				return $wgContLang->getDirMark();</del></td></tr>
<tr id="178"><td class="linenumbers"> </td><td class="linenumbers">2954</td><td class="ins"><ins>+				return $pageLang->getDirMark();</ins></td></tr>
<tr id="179"><td class="linenumbers">2953</td><td class="linenumbers">2955</td><td class="unchanged"><span> 			case 'contentlanguage':</span></td></tr>
<tr id="180"><td class="linenumbers">2954</td><td class="linenumbers">2956</td><td class="unchanged"><span> 				global $wgLanguageCode;</span></td></tr>
<tr id="181"><td class="linenumbers">2955</td><td class="linenumbers">2957</td><td class="unchanged"><span> 				return $wgLanguageCode;</span></td></tr>
</table>
</div>
<h2 id='code-references'>Follow-up revisions</h2>
<table border='1' class='wikitable'><tr><th>Revision</th><th>Commit summary</th><th>Author</th><th>Date</th></tr><tr class='mw-codereview-status-ok'><td><a href="./94716.html" title="Special:Code/MediaWiki/94716">r94716</a></td><td>Follow-up <a href="./94680.html" title="Special:Code/MediaWiki/94680">r94680</a> - fix unit tests....</td><td><a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/author/bawolff" title="Special:Code/MediaWiki/author/bawolff">bawolff</a></td><td>00:46, 17 August 2011</td></tr></table><h2 id='code-comments'>Comments</h2>
<div class='mw-codereview-comments'><div class="mw-codereview-comment" id="c20945" style="margin-left: 0px"><div class="mw-codereview-comment-meta"><a href="./94680.html#c20945" title="Special:Code/MediaWiki/94680">#</a>Comment by <a href="https://www.mediawiki.org/wiki/User:SPQRobin" class="mw-userlink" title="User:SPQRobin"><bdi>SPQRobin</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:SPQRobin" class="mw-usertoollinks-talk" title="User talk:SPQRobin">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/SPQRobin" class="mw-usertoollinks-contribs" title="Special:Contributions/SPQRobin">contribs</a>)</span> &#160; 19:30, 16 August 2011 </div><div class="mw-codereview-comment-text mw-content-ltr"><p>See <a href="https://www.mediawiki.org/wiki/Language_in_MediaWiki" class="mw-redirect" title="Language in MediaWiki">language in MediaWiki</a> for more info.
</p></div></div>
<div class="mw-codereview-comment" id="c20952" style="margin-left: 0px"><div class="mw-codereview-comment-meta"><a href="./94680.html#c20952" title="Special:Code/MediaWiki/94680">#</a>Comment by <a href="https://www.mediawiki.org/wiki/User:Hashar" class="mw-userlink" title="User:Hashar"><bdi>Hashar</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:Hashar" class="mw-usertoollinks-talk" title="User talk:Hashar">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/Hashar" class="mw-usertoollinks-contribs" title="Special:Contributions/Hashar">contribs</a>)</span> &#160; 20:39, 16 August 2011 </div><div class="mw-codereview-comment-text mw-content-ltr"><p>breaks cruisecontrol <a class="external text" href="https://ci.tesla.usability.wikimedia.org/cruisecontrol/buildresults/mw">http://ci.tesla.usability.wikimedia.org/cruisecontrol/buildresults/mw</a>
</p></div></div>
<div class="mw-codereview-comment" id="c20972" style="margin-left: 0px"><div class="mw-codereview-comment-meta"><a href="./94680.html#c20972" title="Special:Code/MediaWiki/94680">#</a>Comment by <a href="https://www.mediawiki.org/wiki/User:Bawolff" class="mw-userlink" title="User:Bawolff"><bdi>Bawolff</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:Bawolff" class="mw-usertoollinks-talk" title="User talk:Bawolff">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/Bawolff" class="mw-usertoollinks-contribs" title="Special:Contributions/Bawolff">contribs</a>)</span> &#160; 01:26, 17 August 2011 </div><div class="mw-codereview-comment-text mw-content-ltr"><p>I fixed the unit test so re-setting to new (cruise control is still throwing a hissy and blaming this revision over <a href="./94714.html" title="Special:Code/MediaWiki/94714">r94714</a> though)
</p></div></div>
<div class="mw-codereview-comment" id="c20973" style="margin-left: 48px"><div class="mw-codereview-comment-meta"><a href="./94680.html#c20973" title="Special:Code/MediaWiki/94680">#</a>Comment by <a href="https://www.mediawiki.org/wiki/User:Hashar" class="mw-userlink" title="User:Hashar"><bdi>Hashar</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:Hashar" class="mw-usertoollinks-talk" title="User talk:Hashar">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/Hashar" class="mw-usertoollinks-contribs" title="Special:Contributions/Hashar">contribs</a>)</span> &#160; 06:13, 17 August 2011 </div><div class="mw-codereview-comment-text mw-content-ltr"><p>Thanks for fixing tests!
</p></div></div>
<div class="mw-codereview-comment" id="c21010" style="margin-left: 0px"><div class="mw-codereview-comment-meta"><a href="./94680.html#c21010" title="Special:Code/MediaWiki/94680">#</a>Comment by <a href="https://www.mediawiki.org/wiki/User:Bawolff" class="mw-userlink" title="User:Bawolff"><bdi>Bawolff</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:Bawolff" class="mw-usertoollinks-talk" title="User talk:Bawolff">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/Bawolff" class="mw-usertoollinks-contribs" title="Special:Contributions/Bawolff">contribs</a>)</span> &#160; 16:27, 17 August 2011 </div><div class="mw-codereview-comment-text mw-content-ltr"><p>We should probably add a new magic word for page language to go along with {{CONTENTLANGUAGE}}, for completeness.
</p></div></div>
<div class="mw-codereview-comment" id="c21304" style="margin-left: 48px"><div class="mw-codereview-comment-meta"><a href="./94680.html#c21304" title="Special:Code/MediaWiki/94680">#</a>Comment by <a href="https://www.mediawiki.org/wiki/User:SPQRobin" class="mw-userlink" title="User:SPQRobin"><bdi>SPQRobin</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:SPQRobin" class="mw-usertoollinks-talk" title="User talk:SPQRobin">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/SPQRobin" class="mw-usertoollinks-contribs" title="Special:Contributions/SPQRobin">contribs</a>)</span> &#160; 21:01, 22 August 2011 </div><div class="mw-codereview-comment-text mw-content-ltr"><p>Yeah, was thinking about it as well. However, didn't add it because I thought it would be better to add it when it is requested/needed.
</p></div></div></div><h2 id='code-changes'>Status &amp; tagging log</h2>
<ul class='mw-codereview-changes'><li>21:37, 24 August 2011&#160;<a href="https://www.mediawiki.org/wiki/User:%F0%9F%98%82" class="mw-userlink" title="User:😂"><bdi>😂</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:%F0%9F%98%82" class="mw-usertoollinks-talk" title="User talk:😂">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/%F0%9F%98%82" class="mw-usertoollinks-contribs" title="Special:Contributions/😂">contribs</a>)</span>&#160;changed the <b>status</b> of r94680 <i>[<b>removed:</b> new&#160;<b>added:</b> resolved]</i></li>
<li>01:26, 17 August 2011&#160;<a href="https://www.mediawiki.org/wiki/User:Bawolff" class="mw-userlink" title="User:Bawolff"><bdi>Bawolff</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:Bawolff" class="mw-usertoollinks-talk" title="User talk:Bawolff">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/Bawolff" class="mw-usertoollinks-contribs" title="Special:Contributions/Bawolff">contribs</a>)</span>&#160;changed the <b>status</b> of r94680 <i>[<b>removed:</b> fixme&#160;<b>added:</b> new]</i></li>
<li>20:39, 16 August 2011&#160;<a href="https://www.mediawiki.org/wiki/User:Hashar" class="mw-userlink" title="User:Hashar"><bdi>Hashar</bdi></a> <span class="mw-usertoollinks">(<a href="https://www.mediawiki.org/wiki/User_talk:Hashar" class="mw-usertoollinks-talk" title="User talk:Hashar">talk</a> | <a href="https://www.mediawiki.org/wiki/Special:Contributions/Hashar" class="mw-usertoollinks-contribs" title="Special:Contributions/Hashar">contribs</a>)</span>&#160;changed the <b>status</b> of r94680 <i>[<b>removed:</b> new&#160;<b>added:</b> fixme]</i></li></ul></form></div>
</body>
</html>
 contentType 9 text/html url 64 https://static-codereview.wikimedia.org:443/MediaWiki/94680.html responseCode 3 200 