tackjmyicinoqgcarkmolcwkjizqskwobqkmfmzo length 5 35432 page 35432 <!DOCTYPE HTML>
<html lang="en">
  <head>
<!-- PDTQ-131 -->
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N3RT7TD');</script>
<!-- End Google Tag Manager -->
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Heroku Deployment - Travis CI</title>
<link rel="stylesheet" href="/assets/stylesheets/main.css">
<link rel="alternate" type="application/rss+xml" title="Travis CI Build Environment Updates" href="https://docs.travis-ci.com/feed.build-env-updates.xml">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" defer></script>

<script src="/assets/javascripts/main.js" type="text/javascript" charset="utf-8" defer></script>
<script src="/assets/javascripts/prism.js" type="text/javascript" charset="utf-8" defer></script>
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@travisci" />
<meta name="twitter:creator" content="@travisci" />
<meta property="og:title" content="Travis CI Documentation" />
<meta property="og:type" content="website" />
<meta property="og:url" content=/user/deployment/heroku/ />
<meta property="og:description" content="Heroku Deployment" />
<meta property="og:image" content="/images/TravisCI-Full-Color.png" }} />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="642" />
<meta property="og:image:height" content="201" />
<meta property="og:image:alt" content="Travis CI logo" />


 

  </head>
  <body>
<!-- PDTQ-131 -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N3RT7TD"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <div class="wrapper">

      <header class="top">
  <div class="row topbar">
    <h1 id="logo" class="logo">
  <a href="https://travis-ci.com/" title="Travis CI">Travis</a>
</h1>

    <nav>
      <ul id="navigation" class="navigation">
        <li><a href="https://blog.travis-ci.com">Blog</a></li>
        <li><a href="/">Docs</a></li>
        <li class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></li>
      </ul>
    </nav>
  </div>
</header>


      <div id="content" class="row">

        <div id="sidebar" class="sidebar">
  <div>
    <!-- <h2>Search</h2> -->
    <div class="searchbox">
      <form>
        <input type="text" id="st-search-input" class="searchbox-input" placeholder="Search the docs" />
      </form>
      <script type="text/javascript">
      var Swiftype = window.Swiftype || {};
        (function() {
          Swiftype.key = 'tXvDDzd4fNTBnLvxfEyx';

          Swiftype.searchSearchFields = {
            "page": ["title, body, tags"]
          };
          Swiftype.autocompleteSearchFields = {
            "page": ["title, body, tags"]
          };
          /** DO NOT EDIT BELOW THIS LINE **/
          var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
          script.src = "//swiftype.com/embed.js";
          var entry = document.getElementsByTagName('script')[0];
          document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
        }());
      </script>
    </div>
  </div>

  <section class="sidebar-navigation">
    <nav>
      <h3>Getting Started</h3>
      <ul>
        <li><a href="/user/for-beginners/">Core Concepts for Beginners</a></li>
        <li><a href="/user/tutorial/">Travis CI Tutorial</a></li>
        <li><a href="/user/customizing-the-build/">Customizing the Build</a></li>
        <li><a href="/user/speeding-up-the-build/">Speeding up the Build</a></li>
        <li><a href="/user/docker/">Using Docker in your Build</a></li>
        <li><a href="/user/gui-and-headless-browsers/">Headless Testing with Browsers</a></li>
        <li><a href="/user/pull-requests/">Building Pull Requests</a></li>
        <li><a href="/user/cron-jobs/">Cron Jobs</a></li>
        <li><a href="/user/common-build-problems/">Common Build Problems</a></li>
        <li><a href="https://github.com/travis-ci/travis#readme">Command Line Client</a></li>
        <li><a href="/user/build-config-imports/">Build Config Imports</a></li>
        <li><a href="/user/build-config-validation/">Build Config Validation</a></li>
      </ul>

      <h3>Jobs, Builds, Matrices and Stages</h3>
      <ul>
        <li><a href="/user/job-lifecycle/">Job Lifecycle</a></li>
        <li><a href="/user/build-matrix/">Build Matrix</a></li>
        <li><a href="/user/build-stages/">Build Stages</a></li>
        <li><a href="/user/conditional-builds-stages-jobs/">Conditional Builds, Stages, and Jobs</a></li>
      </ul>

      <h3>Installing Dependencies</h3>
      <ul>
        <li><a href="/user/installing-dependencies/">Installing Dependencies</a></li>
        <li><a href="/user/private-dependencies/">Private Dependencies GitHub</a></li>
        <li><a href="/user/private-dependencies-bb/">Private Dependencies Bitbucket</a></li>
        <li><a href="/user/database-setup/">Setting up Services and Databases</a></li>
        <li><a href="/user/caching/">Caching Dependencies</a></li>
        <li><a href="/user/using-workspaces/">Caching Dependencies within a Build (Workspaces)</a></li>
        <li><a href="/user/ssh-known-hosts/">Adding to SSH Known Hosts</a></li>
      </ul>

      <h3>Programming Languages</h3>
      <ul>
      
        <li><a href="/user/languages/android/">Android</a></li>
      
        <li><a href="/user/languages/c/">C</a></li>
      
        <li><a href="/user/languages/csharp/">C#</a></li>
      
        <li><a href="/user/languages/cpp/">C++</a></li>
      
        <li><a href="/user/languages/clojure/">Clojure</a></li>
      
        <li><a href="/user/languages/crystal/">Crystal</a></li>
      
        <li><a href="/user/languages/d/">D</a></li>
      
        <li><a href="/user/languages/dart/">Dart</a></li>
      
        <li><a href="/user/languages/elixir/">Elixir</a></li>
      
        <li><a href="/user/languages/elm/">Elm</a></li>
      
        <li><a href="/user/languages/erlang/">Erlang</a></li>
      
        <li><a href="/user/languages/csharp/">F#</a></li>
      
        <li><a href="/user/languages/minimal-and-generic/">Generic</a></li>
      
        <li><a href="/user/languages/go/">Go</a></li>
      
        <li><a href="/user/languages/groovy/">Groovy</a></li>
      
        <li><a href="/user/languages/haskell/">Haskell</a></li>
      
        <li><a href="/user/languages/haxe/">Haxe</a></li>
      
        <li><a href="/user/languages/java/">Java</a></li>
      
        <li><a href="/user/languages/javascript-with-nodejs/">JavaScript <small>(with Node.js)</small></a></li>
      
        <li><a href="/user/languages/julia/">Julia</a></li>
      
        <li><a href="/user/languages/matlab/">MATLAB</a></li>
      
        <li><a href="/user/languages/minimal-and-generic/">Minimal</a></li>
      
        <li><a href="/user/languages/nix/">Nix</a></li>
      
        <li><a href="/user/languages/objective-c/">Objective-C</a></li>
      
        <li><a href="/user/languages/perl/">Perl</a></li>
      
        <li><a href="/user/languages/perl6/">Perl6</a></li>
      
        <li><a href="/user/languages/php/">PHP</a></li>
      
        <li><a href="/user/languages/python/">Python</a></li>
      
        <li><a href="/user/languages/r/">R</a></li>
      
        <li><a href="/user/languages/ruby/">Ruby</a></li>
      
        <li><a href="/user/languages/rust/">Rust</a></li>
      
        <li><a href="/user/languages/scala/">Scala</a></li>
      
        <li><a href="/user/languages/smalltalk/">Smalltalk</a></li>
      
        <li><a href="/user/languages/objective-c/">Swift</a></li>
      
        <li><a href="/user/languages/csharp/">Visual Basic</a></li>
      
        <li><a href="/user/languages/community-supported-languages/">Adding a language</a></li>
      </ul>

      <h3>Deployments and Uploads</h3>
      <ul>
        
          <li class="is-overview"><a href="/user/deployment/">Overview</a></li>
          
        
        
          <li><a href="/user/deployment/anynines/">anynines</a></li>
        
          <li><a href="/user/deployment/atlas/">Atlas</a></li>
        
          <li><a href="/user/deployment/codedeploy/">AWS CodeDeploy</a></li>
        
          <li><a href="/user/deployment/elasticbeanstalk/">AWS Elastic Beanstalk</a></li>
        
          <li><a href="/user/deployment/lambda/">AWS Lambda</a></li>
        
          <li><a href="/user/deployment/opsworks/">AWS OpsWorks</a></li>
        
          <li><a href="/user/deployment/s3/">AWS S3</a></li>
        
          <li><a href="/user/deployment/azure-web-apps/">Azure Web Apps</a></li>
        
          <li><a href="/user/deployment/bintray/">bintray</a></li>
        
          <li><a href="/user/deployment/bitballoon/">BitBalloon</a></li>
        
          <li><a href="/user/deployment/bluemixcloudfoundry/">Bluemix CloudFoundry</a></li>
        
          <li><a href="/user/deployment/boxfuse/">Boxfuse</a></li>
        
          <li><a href="/user/deployment/catalyze/">Catalyze</a></li>
        
          <li><a href="/user/deployment/chefsupermarket/">Chef Supermarket</a></li>
        
          <li><a href="/user/deployment/cloud66/">Cloud 66</a></li>
        
          <li><a href="/user/deployment/cloudfoundry/">CloudFoundry</a></li>
        
          <li><a href="/user/deployment/cargo/">Cargo</a></li>
        
          <li><a href="/user/deployment/engineyard/">Engine Yard</a></li>
        
          <li><a href="/user/deployment/pages/">GitHub Pages</a></li>
        
          <li><a href="/user/deployment/releases/">GitHub Releases</a></li>
        
          <li><a href="/user/deployment/google-app-engine/">Google App Engine</a></li>
        
          <li><a href="/user/deployment/gcs/">Google Cloud Storage</a></li>
        
          <li><a href="/user/deployment/firebase/">Google Firebase</a></li>
        
          <li><a href="/user/deployment/hackage/">Hackage</a></li>
        
          <li><a href="/user/deployment/hephy/">Hephy</a></li>
        
          <li><a href="/user/deployment/heroku/">Heroku</a></li>
        
          <li><a href="/user/deployment/launchpad/">Launchpad</a></li>
        
          <li><a href="/user/deployment/npm/">npm</a></li>
        
          <li><a href="/user/deployment/openshift/">OpenShift</a></li>
        
          <li><a href="/user/deployment/packagecloud/">packagecloud.io</a></li>
        
          <li><a href="/user/deployment/puppetforge/">Puppet Forge</a></li>
        
          <li><a href="/user/deployment/pypi/">PyPI</a></li>
        
          <li><a href="/user/deployment/cloudfiles/">Rackspace Cloud Files</a></li>
        
          <li><a href="/user/deployment/rubygems/">RubyGems</a></li>
        
          <li><a href="/user/deployment/scalingo/">Scalingo</a></li>
        
          <li><a href="/user/deployment/script/">Script</a></li>
        
          <li><a href="/user/deployment/snaps/">Snap Store</a></li>
        
          <li><a href="/user/deployment/surge/">Surge.sh</a></li>
        
          <li><a href="/user/deployment/testfairy/">TestFairy</a></li>
        
          <li><a href="/user/deployment/transifex/">Transifex</a></li>
        
        <li><a href="/user/uploading-artifacts/">Uploading Build Artifacts</a></li>
      </ul>

      <h3>CI Environment Reference</h3>
      <ul>
        <li class="is-overview"><a href="/user/reference/overview/">Overview</a></li>
        <li><a href="/user/reference/linux/">Ubuntu Linux CI Environment References</a></li>
        <li><a href="/user/reference/osx/">macOS CI Environment Reference</a></li>
        <li><a href="/user/reference/windows/">Windows CI Environment Reference</a></li>
        <li><a href="/user/reference/freebsd/">FreeBSD CI Environment Reference</a></li>
        <li><a href="/user/multi-os/">Building on Multiple Operating Systems</a></li>
        <li><a href="/user/multi-cpu-architectures/">Building on Multiple CPU Architectures</a></li>
        <li><a href="/user/environment-variables/">Environment Variables</a></li>
        <li><a href="/user/build-environment-updates/">Build Environment Updates</a></li>
        <li><a href="/user/ip-addresses/">Build Machines IP Addresses</a></li>
      </ul>

      <h3>Security and Secure Software Supply Chain</h3>
      <ul>
        <li><a href="/user/encryption-keys/">Encrypting Sensitive Data</a></li>
        <li><a href="/user/encrypting-files/">Encrypting Files</a></li>
        <li><a href="/user/github-oauth-scopes/">GitHub Permissions used by Travis CI</a></li>
        <li><a href="/user/bb-oauth-scopes/">Bitbucket Permissions used by Travis CI</a></li>
        <li><a href="/user/assembla-oauth-scopes/">Assembla Permissions used by Travis CI</a></li>
        <li><a href="/user/gl-oauth-scopes/">GitLab Permissions used by Travis CI</a></li>
        <li><a href="/user/disable-job-logs/">Disable Job Logs Availability</a></li>
        <li><a href="/user/best-practices-security/">Best Practices in Securing Your Data</a></li>
        <li><a href="/user/securely-signing-software">Securely Signing Software</a></li>
        <li><a href="/user/sbom">Software Bill of Materials</a></li>
      </ul>

      <h3>Integrations and Notifications</h3>
      <ul>
        <li><a href="/user/notifications/">Configuring Notifications</a></li>
        <li><a href="/user/status-images/">Showing Build Status Images</a></li>
        <li><a href="/user/code-climate/">Code Climate</a></li>
        <li><a href="/user/deepsource/">DeepSource</a></li>
        <li><a href="/user/coveralls/">Coveralls</a></li>
        <li><a href="/user/coverity-scan/">Coverity Scan</a></li>
        <li><a href="/user/browserstack/">BrowserStack</a></li>
        <li><a href="/user/sauce-connect/">Sauce Labs</a></li>
        <li><a href="/user/sonarcloud/">SonarCloud</a></li>
        <li><a href="/user/sourceclear/">SourceClear</a></li>
        <li><a href="/user/build-feeds/">Atom Feeds</a></li>
        <li><a href="/user/cc-menu/">CCMenu / CCTray Feeds</a></li>
        <li><a href="/user/integration/platformio/">Embedded Builds with PlatformIO</a></li>
        <li><a href="/user/hashicorp-vault-integration">Hashicorp Vault</a></li>
        <li><a href="/user/apps/">3rd Party Apps, Clients and Tools</a></li>
      </ul>

      <h3>Developer Program</h3>
      <ul>
        <li class="is-overview"><a href="/user/developer/">Overview</a></li>
        <li><a href="https://developer.travis-ci.com/">API V3</a></li>
        <li><a href="/user/triggering-builds/">Triggering Builds with API V3</a></li>
        <li><a href="https://github.com/travis-ci/travis#ruby-library">The Ruby Library</a></li>
      </ul>
      
      <h3>Hosted Billing</h3>
      <ul>
        <li class="is-overview"><a href="/user/billing-overview/">Overview</a></li>
        <li><a href="/user/billing-autorefill/">Auto-refill</a></li>
        <li><a href="/user/billing-faq/">FAQ</a></li>
      </ul>

      <h3>Travis CI Enterprise</h3>
      <ul>
        <li><a href="/user/enterprise/">Enterprise Docs</a></li>
      </ul>

    </nav>
  </section>

  <section class="sidebar-notice">
    <p>This documentation site is Open Source.
      The <a href="https://github.com/travis-ci/docs-travis-ci-com">README in our Git repository</a> explains how to contribute.</p>
    <p>Travis CI relies on Open Source <a href="/user/open_source_license/">licensing information</a>.</p>
  </section>

</div><!-- /#sidebar -->


        <main id="main" class="main" data-swiftype-index='true'>
          
            <aside class="improve-page" data-swiftype-index='false'><a href="https://github.com/travis-ci/docs-travis-ci-com/edit/master/user/deployment/heroku.md" target="_blank" title="Edit this page on GitHub" class="button-pen" data-proofer-ignore>Improve this page on GitHub</a></aside>
            <h1 class="title">Heroku Deployment</h1>
          

          
            <blockquote>
              <p>
                This page documents deployments using dpl v1 which currently is the default
                version. The next major version dpl v2 will be released soon, and we recommend
                starting to use it. Please see <a href="https://blog.travis-ci.com/2019-08-27-deployment-tooling-dpl-v2-preview-release">our blog post</a>
                for details. <a href="/user/deployment-v2">dpl v2 documentation can be found here</a>.
              </p>
            </blockquote>
          


          
            <div id="toc" class="toc">
              <ul class="list-language">
  <li><a href="#deploying-custom-application-names">Deploying Custom Application Names</a></li>
  <li><a href="#deploying-specific-branches">Deploying Specific Branches</a></li>
  <li><a href="#running-commands">Running Commands</a></li>
  <li><a href="#deploying-build-artifacts">Deploying build artifacts</a></li>
</ul>

            </div>
          

          <p>Travis CI can automatically deploy your <a href="https://www.heroku.com/">Heroku</a> application after a successful build.</p>

<p>To use the default configuration, add your encrypted Heroku api key to your <code class="highlighter-rouge">.travis.yml</code>:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span>
    <span class="na">secure</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">ENCRYPTED</span><span class="nv"> </span><span class="s">API</span><span class="nv"> </span><span class="s">KEY"</span>
</code></pre></div></div>

<p>If you have both the <a href="https://devcenter.heroku.com/articles/heroku-cli">Heroku</a> and <a href="https://github.com/travis-ci/travis.rb#readme">Travis CI</a> command line clients installed, you can get your key, encrypt it and add it to your <code class="highlighter-rouge">.travis.yml</code> by running the following command from your project directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>travis encrypt <span class="si">$(</span>heroku auth:token<span class="si">)</span> <span class="nt">--add</span> deploy.api_key
</code></pre></div></div>

<p><code class="highlighter-rouge">travis</code> command defaults to using <a href="https://travis-ci.org">travis-ci.org</a> as the API endpoint. If your build runs on <a href="https://travis-ci.com">travis-ci.com</a> (even if your repository is public), add <code class="highlighter-rouge">--pro</code> flag to override this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>travis encrypt <span class="si">$(</span>heroku auth:token<span class="si">)</span> <span class="nt">--add</span> deploy.api_key <span class="nt">--pro</span>
</code></pre></div></div>
<p>You can also use the Travis CI command line setup tool <code class="highlighter-rouge">travis setup heroku</code>.</p>

<h2 id="deploying-custom-application-names">Deploying Custom Application Names <a href="#deploying-custom-application-names" class="toc-anchor">#</a></h2>

<p>By default, we will try to deploy to an application by the same name as the repository. For example, if you deploy an application from the GitHub repository <a href="https://github.com/travis-ci/travis-chat">travis-ci/travis-chat</a> without explicitly specify the name of the application, Travis CI will try to deploy to a Heroku app named <em>travis-chat</em>.</p>

<p>You can explicitly set the name via the <strong>app</strong> option:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">app</span><span class="pi">:</span> <span class="s">my-app-123</span>
</code></pre></div></div>

<p>It is also possible to deploy different branches to different applications:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">app</span><span class="pi">:</span>
    <span class="na">master</span><span class="pi">:</span> <span class="s">my-app-staging</span>
    <span class="na">production</span><span class="pi">:</span> <span class="s">my-app-production</span>
</code></pre></div></div>

<p>If these apps belong to different Heroku accounts, you will have to do the same for the API key:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span>
    <span class="na">master</span><span class="pi">:</span> <span class="s">...</span>
    <span class="na">production</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">app</span><span class="pi">:</span>
    <span class="na">master</span><span class="pi">:</span> <span class="s">my-app-staging</span>
    <span class="na">production</span><span class="pi">:</span> <span class="s">my-app-production</span>
</code></pre></div></div>

<h2 id="deploying-specific-branches">Deploying Specific Branches <a href="#deploying-specific-branches" class="toc-anchor">#</a></h2>

<p>If you have branch specific options, as <a href="#deploying-custom-application-names">shown above</a>, Travis CI will automatically figure out which branches to deploy from. Otherwise, it will only deploy from your <strong>master</strong> branch.</p>

<p>You can also explicitly specify the branch to deploy from with the <strong>on</strong> option:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">on</span><span class="pi">:</span> <span class="s">production</span>
</code></pre></div></div>

<p>Alternatively, you can also configure it to deploy from all branches:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">on</span><span class="pi">:</span>
    <span class="na">all_branches</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<p>Builds triggered from Pull Requests will never trigger a deploy.</p>

<h2 id="running-commands">Running Commands <a href="#running-commands" class="toc-anchor">#</a></h2>

<p>In some setups, you might want to run a command on Heroku after a successful deploy. You can do this with the <strong>run</strong> option:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">run</span><span class="pi">:</span> <span class="s2">"</span><span class="s">rake</span><span class="nv"> </span><span class="s">db:migrate"</span>
</code></pre></div></div>

<p>It also accepts a list of commands:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">run</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">rake</span><span class="nv"> </span><span class="s">db:migrate"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">rake</span><span class="nv"> </span><span class="s">cleanup"</span>
</code></pre></div></div>

<blockquote>
  <p>Take note that Heroku app might not be completely deployed and ready to serve requests when we run your commands. To mitigate this situation, you can add a <code class="highlighter-rouge">sleep</code> statement to add a delay before your commands.</p>
</blockquote>

<h3 id="error-logs-for-custom-commands">Error Logs for Custom Commands <a href="#error-logs-for-custom-commands" class="toc-anchor">#</a></h3>

<p>Custom Heroku commands do not affect the Travis CI build status or trigger Travis CI notifications.</p>

<p>Use an addon such as <a href="https://elements.heroku.com/addons/papertrail" data-proofer-ignore="">Papertrail</a> or <a href="https://elements.heroku.com/addons/logentries" data-proofer-ignore="">Logentries</a> to get notifications for <code class="highlighter-rouge">rake db:migrate</code> or other commands.</p>

<p>These add-ons have email notification systems that can be triggered when certain string matches occur in your Heroku logs. For example you could trigger an e-mail notification if the log contains “this and all later migrations canceled”.</p>

<h3 id="restarting-applications">Restarting Applications <a href="#restarting-applications" class="toc-anchor">#</a></h3>

<p>Sometimes you want to restart your Heroku application between or after commands. You can easily do so by adding a “restart” command:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">run</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">rake</span><span class="nv"> </span><span class="s">db:migrate"</span>
    <span class="pi">-</span> <span class="s">restart</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">rake</span><span class="nv"> </span><span class="s">cleanup"</span>
</code></pre></div></div>

<h2 id="deploying-build-artifacts">Deploying build artifacts <a href="#deploying-build-artifacts" class="toc-anchor">#</a></h2>

<p>After your tests ran and before the deploy, Travis CI will clean up any additional files and changes you made.</p>

<p>Maybe that is not what you want, as you might generate some artifacts (think asset compilation) that are supposed to be deployed, too. There is now an option to skip the clean up:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<h3 id="conditional-deploys">Conditional Deploys <a href="#conditional-deploys" class="toc-anchor">#</a></h3>

<p>It is possible to make deployments conditional using the <strong>on</strong> option:</p>

<pre><code>deploy:
  provider: heroku
  api_key: ...
  on:
    branch: staging
    rvm: 2.0.0
</code></pre>

<p>The above configuration will trigger a deploy if the staging branch is passing on Ruby 2.0.0.</p>

<p>You can also add custom conditions:</p>

<pre><code>deploy:
  provider: heroku
  api_key: ...
  on:
    condition: "$CC = gcc"
</code></pre>

<p>Available conditions are:</p>

<ul>
<li><strong>all_branches</strong> - when set to true, trigger deploy from any branch if passing</li>
<li><strong>branch</strong> - branch or list of branches to deploy from if
  passing, defaults to master if no branch is specified.</li>
<li><strong>tags</strong> - when set to true, Travis CI only deploys on tagged
  builds. Due to a limitation, this condition must be paired with `all_branches`
set to true. Otherwise the default condition for branches will interfere with
the tags condition.</li>
<li><strong>condition</strong> - custom condition or list of custom conditions</li>
<li><strong>jdk</strong> - JDK version to deploy from if passing</li>
<li><strong>node</strong> - NodeJS version to deploy from if passing</li>
<li><strong>perl</strong> - Perl version to deploy from if passing</li>
<li><strong>php</strong> - PHP version to deploy from if passing</li>
<li><strong>python</strong> - Python version to deploy from if passing</li>
<li><strong>ruby</strong> - Ruby version to deploy from if passing</li>
<li><strong>repo</strong> - only trigger a build for the given repository, to play nice with forks</li>
</ul>

<h3 id="deploy-strategy">Deploy Strategy <a href="#deploy-strategy" class="toc-anchor">#</a></h3>

<p>Travis CI supports different mechanisms for deploying to Heroku:</p>

<ul>
  <li><strong>api:</strong> Uses Heroku’s <a href="https://devcenter.heroku.com/articles/build-and-release-using-the-api">Build API</a>. This is the default strategy.</li>
  <li><strong>git:</strong> Does a <code class="highlighter-rouge">git push</code> over HTTPS.</li>
</ul>

<p>It defaults to <strong>api</strong>, but you can change that via the <strong>strategy</strong> option:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">heroku</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">strategy</span><span class="pi">:</span> <span class="s">git</span>
</code></pre></div></div>

<h4 id="using-gitignore-on-git-strategy">Using <code class="highlighter-rouge">.gitignore</code> on <code class="highlighter-rouge">git</code> strategy <a href="#using-gitignore-on-git-strategy" class="toc-anchor">#</a></h4>

<p>When you use any of the <code class="highlighter-rouge">git</code> strategies, be mindful that the deployment will
honor <code class="highlighter-rouge">.gitignore</code>.</p>

<p>If your <code class="highlighter-rouge">.gitignore</code> file matches something that your build creates, use
<a href="#running-commands-before-and-after-deploy"><code class="highlighter-rouge">before_deploy</code></a> to change
its content.</p>

<h3 id="running-commands-before-and-after-deploy">Running commands before and after deploy <a href="#running-commands-before-and-after-deploy" class="toc-anchor">#</a></h3>

<p>Sometimes you want to run commands before or after deploying. You can use the <code class="highlighter-rouge">before_deploy</code> and <code class="highlighter-rouge">after_deploy</code> stages for this. These will only be triggered if Travis CI is actually deploying.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">before_deploy</span><span class="pi">:</span> <span class="s2">"</span><span class="s">echo</span><span class="nv"> </span><span class="s">'ready?'"</span>
<span class="na">deploy</span><span class="pi">:</span>
  <span class="s">..</span>
<span class="na">after_deploy</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">./after_deploy_1.sh</span>
  <span class="pi">-</span> <span class="s">./after_deploy_2.sh</span>
</code></pre></div></div>


        </main>
      </div><!-- /#content -->

      <footer class="footer">
  <div class="layout-inner">
    <div class="footer-elem">
      <svg width="142px" height="45.381px" viewBox="0 0 142 45.381" enable-background="new 0 0 142 45.381" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink= "http://www.w3.org/1999/xlink">
        <title>Travis CI Mascot</title>
        <image xlink:href="https://styleguide.travis-ci.com/images/logos/travis-footer-logo-new.svg" x="0" y="0" width="142px" height="45.381px" />
      </svg>
    </div>

    <div class="footer-elem"></div>

    <div class="footer-elem">
      <h3 class="footer-title">©Travis CI, GmbH</h3>
      <address>Rigaer Straße 8<br>10247 Berlin, Germany</address>
      <ul>
        <li><a href="https://travisci.workable.com/" title="Jobs at Travis CI">Work with Travis CI</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Help</h3>
      <ul>
        <li><a href="https://docs.travis-ci.com" title="Travis CI Docs">Documentation</a></li>
        <li><a href="https://changelog.travis-ci.com/">Changelog</a></li>
        <li><a href="https://blog.travis-ci.com/" title="Travis CI Blog">Blog</a></li>
        <li><a href="mailto:support@travis-ci.com" title="Email Travis CI support">Email</a></li>
        <li><a href="https://twitter.com/travisci" title="Travis CI on Twitter">Twitter</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Company</h3>
      <ul>
        <li><a href="/imprint.html" title="Imprint">Imprint</a></li>
        <li><a href="https://ideracorp.com/legal/TravisCI">Legal</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Travis CI Status</h3>
      <ul>
        <li><div class="status-circle none">Status:</div>
          <a href="http://www.traviscistatus.com/">Travis CI Status</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

<script>
 fetch('https://pnpcptp8xh9k.statuspage.io/api/v2/status.json').then(function(response) {
   return response.json();
 }).then(function(data) {
   if (data.status && data.status.indicator) {
     document.querySelector('.status-circle').classList.add(data.status.indicator);
   }
 });
</script>

    </div><!-- /.wrapper -->
  </body>
</html>
 contentType 9 text/html url 54 https://docs.travis-ci.com:443/user/deployment/heroku/ responseCode 3 200 