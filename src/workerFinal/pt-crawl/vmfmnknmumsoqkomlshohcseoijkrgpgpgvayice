vmfmnknmumsoqkomlshohcseoijkrgpgpgvayice length 5 36205 page 36205 <!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sending Emails &#8212; Cordra  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/minimal-fixes.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="External Authentication Provider" href="external-authentication-provider.html" />
    <link rel="prev" title="OAI-PMH in Cordra" href="oai-pmh.html" />
    <link rel="shortcut icon" href="../_static/img/favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700%7COpen+Sans:300,400,700,800' rel='stylesheet' />
    <link href='https://fonts.googleapis.com/css?family=Rasa:400,700%7COpen+Sans:300,400,700,800' rel='stylesheet' />
    <link rel="stylesheet" href="../_static/libs/font-awesome/css/font-awesome.min.css"></link>
    <link rel="stylesheet" href="../_static/libs/bootstrap/dist/css/bootstrap.min.css"></link>
    <link rel="stylesheet" href="../_static/icons/nucleo.css"></link>
    <link rel="stylesheet" href="../_static/libs/animate.css/animate.min.css"></link>
    <link rel="stylesheet" href="../_static/css/bootstrap.min.css"></link>
    <link rel="stylesheet" href="../_static/css/blog.css"></link>
    <link rel="stylesheet" href="../_static/css/buttons.css"></link>
    <link rel="stylesheet" href="../_static/css/colors.css"></link>
    <link rel="stylesheet" href="../_static/css/footers.css"></link>
    <link rel="stylesheet" href="../_static/css/widgets.css"></link>
    <link rel="stylesheet" href="../_static/css/nav.css"></link>
    <link rel="stylesheet" href="../_static/css/preloader.css"></link>
    <link rel="stylesheet" href="../_static/css/custom.css"></link>
    <link rel="stylesheet" href="../_static/css/ui.css"></link>

  </head><body>
<!-- BEGIN LATERAL NAVIGATION -->
<aside id="aside-nav">
    <div id="main-aside-navigation">
        <div class="main-nav-wrapper">
            <div class="close-aside-nav">
                <i class="nc-icon-outline ui-1_simple-remove"></i>
            </div>
            <div id="aside-logo">
                    <a href="/index.html" data-logo-light="../_static/img/cordra-light.png" data-logo-dark="../_static/img/cordra-primary-blue.png">
                    <img width="170" height="166" src="../_static/img/cordra-primary-blue.png" alt="logo">
                </a>
            </div>
            <nav id="main-aside-menu">
                <ul>
                    <li class="submenu">
                        <a href="/cordra.html">What's Cordra?</a>
                    </li>
                    <li class="submenu">
                        <a href="/getstarted.html">Get Started</a>
                    </li>
                    <li class="submenu">
                        <a href="/download.html">Download</a>
                    </li>
                    <li class="submenu">
                        <a href="/documentation/introduction/introduction.html">Developer Resources</a>
                    </li>
                    <li class="submenu">
                        <a href="/standards.html">Standards</a>
                    </li>
                    <li class="submenu">
                        <a href="../search.html">Search</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</aside>
<!-- END LATERAL NAVIGATION -->

<!-- BEGIN MAIN NAVIGATION -->
<header id="header">
    <div id="main-navigation">
        <div class="main-nav-wrapper">
            <div class="container-fluid">
                <div class="nav-left">
                    <div id="logo">
                        <a href="/index.html" data-logo-light="../_static/img/cordra-light.png" data-logo-dark="../_static/img/cordra-primary-blue.png">
                        <img width="145" height="36" src="../_static/img/cordra-primary-blue.png" alt="logo">
                        </a>
                    </div>
                </div>
                <div class="nav-right">
                    <nav id="main-menu">
                        <ul>
                            <li class="mega-menu menu-layouts">
                                <a href="/cordra.html">What's Cordra?</a>
                            </li>
                            <li class="mega-menu menu-layouts">
                                <a href="/getstarted.html">Get Started</a>
                            </li>
                            <li>
                                <a href="/download.html">Download</a>
                            </li>
                            <li class="mega-menu">
                                <a href="/documentation/introduction/introduction.html">Developer Resources</a>
                            </li>
                            <li class="mega-menu">
                                <a href="/standards.html">Standards</a>
                            </li>
                            <li class="mega-menu">
                                <a href="../search.html">Search</a>
                            </li>
                        </ul>
                    </nav>
                    <ul class="nav-tools">
                        <li class="mobile-menu-btn">
                            <button class="toggle-menu" data-toggle="mobile-menu" data-effect="hover">
                                <span class="menu-label label-left">Menu</span>
                                <i class="nc-icon-outline ui-2_menu-35"></i>
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- END MAIN NAVIGATION -->


  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://hdl.handle.net/20.1000/129">Developer Resources (in PDF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Cordra Software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/introduction.html">Introduction to Cordra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/release-notes.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/system-requirements.html">System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design/index.html">Application Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../design/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/identifiers.html">Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/schemas.html">Schemas/Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/design-object.html">Design Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/payloads.html">Payloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/authentication-and-access-controls.html">Authentication and Access Controls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/javascript-lifecycle-hooks.html">Lifecycle Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/type-methods.html">Type Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/java-hooks-and-methods.html">Java Hooks and Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/handle-integration.html">Handle Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/object-versioning.html">Digital Object Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/object-hashing.html">Digital Object Hashing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/doip.html">DOIP and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/doip-api-for-http-clients.html">DOIP API for HTTP Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/rest-api.html">HTTP REST API and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/search.html">Query Syntax</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../client/index.html">Clients</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../client/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/rest-java.html">REST - Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/javascript.html">REST - JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/doip-java.html">DOIP - Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/third-party.html">Third Party Clients</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/single-instance-deployment.html">Deploying Single-Instance Cordra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/single-instance-production.html">Production Single Instance Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/distributed-deployment.html">Deploying Cordra as a Distributed System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/reindexing.html">Reindexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/logs-management.html">Managing Cordra Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/storage-backends.html">Configuring Storage Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/indexing-backends.html">Configuring Indexing Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/sessions-manager.html">Distributed Sessions Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/user-management.html">Managing Users and Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/admin-user-interface.html">Administrative UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/enabling-tls.html">Enabling TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/https.html">Configuring HTTPS Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/migration.html">Migration across Cordra Environments</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Extensions and Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="calling-java-from-javascript.html">Calling Java from JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-repository.html">Document Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="medical-records-application.html">Medical Records Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="person-registry.html">Person Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="user-registration.html">User Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="object-linking.html">Digital Object Linking</a></li>
<li class="toctree-l2"><a class="reference internal" href="oai-pmh.html">OAI-PMH in Cordra</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sending Emails</a></li>
<li class="toctree-l2"><a class="reference internal" href="external-authentication-provider.html">External Authentication Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="collab-prototype.html">Collab Prototype Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="neo4j-as-an-additional-index.html">Neo4j as an Additional Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="partial-replication-aggregation.html">Partial Replication/Aggregation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/import-export.html">Import and Export Tools</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="sending-emails">
<span id="sendingemails"></span><h1>Sending Emails<a class="headerlink" href="#sending-emails" title="Permalink to this heading">¶</a></h1>
<p>Cordra can be configured to allow sending emails from <a class="reference internal" href="../design/type-methods.html#type-methods"><span class="std std-ref">Type Methods</span></a>. In order to enable this,
you will need to add the supporting jar libraries to your Cordra instance and then configure the emails you wish to send.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>For this example, we’ll use the <a class="reference external" href="http://www.simplejavamail.org">Simple Java Mail</a> emailing library to send emails.
The jar files needed are included in the Cordra distribution, in the <code class="docutils literal notranslate"><span class="pre">extensions/user-registration/lib</span></code> directory.
To install this library, put these jar files into a directory called <code class="docutils literal notranslate"><span class="pre">lib</span></code> in your Cordra data directory. If the <code class="docutils literal notranslate"><span class="pre">lib</span></code>
directory doesn’t exist, create the <code class="docutils literal notranslate"><span class="pre">lib</span></code> directory in the Cordra data directory.</p>
<p>You will need to restart the Cordra server once the Java Mail Client library is installed if your Cordra server is
already running.</p>
</section>
<section id="smtp-configuration">
<h2>SMTP Configuration<a class="headerlink" href="#smtp-configuration" title="Permalink to this heading">¶</a></h2>
<p>Create a file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory called <code class="docutils literal notranslate"><span class="pre">emailServerConfig.json</span></code> with the following contents:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
    &quot;serverAddress&quot;: &quot;smtp.example.com&quot;,
    &quot;serverPort&quot;: 587,
    &quot;enableStartTls&quot;: true,
    &quot;trustHosts&quot;: &quot;smtp.example.com&quot;,
    &quot;username&quot;: &quot;your-smtp-username&quot;,
    &quot;password&quot;: &quot;your-smtp-password&quot;
}
</pre></div>
</div>
<p>Be sure to replace the example settings with the settings for your actual SMTP server. Finding these settings is outside
of the scope of this document, but most email providers have some way of sending emails using SMTP. You can also use
Amazon’s Simple Email Service for testing.</p>
</section>
<section id="email-templates">
<h2>Email Templates<a class="headerlink" href="#email-templates" title="Permalink to this heading">¶</a></h2>
<p>In the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory, create an <code class="docutils literal notranslate"><span class="pre">emailTemplates</span></code> directory. In that directory, create files called
<code class="docutils literal notranslate"><span class="pre">creation.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">creation.html</span></code>. These files should contain the text and html (respective) that should be sent
in the email.</p>
</section>
<section id="id1">
<h2>Sending Emails<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p>As an example, we’ll modify the <code class="docutils literal notranslate"><span class="pre">beforeSchemaValidation</span></code> method on the User object to send an email whenever a
new User object is created. Replace the default User schema javascript with the following:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nx">exports</span><span class="p">.</span><span class="nx">beforeSchemaValidation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">beforeSchemaValidation</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kd">var</span><span class="w"> </span><span class="nx">emailConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="s2">&quot;toAddress&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;test@example.com&quot;</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="s2">&quot;fromAddress&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="s2">&quot;subject&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;testing javascript email&quot;</span>
<span class="linenos"> 7</span><span class="p">};</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kd">function</span><span class="w"> </span><span class="nx">beforeSchemaValidation</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span><span class="w"> </span><span class="nx">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">isNew</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">11</span><span class="w">        </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">emailConfig</span><span class="p">.</span><span class="nx">toAddress</span><span class="p">);</span>
<span class="linenos">12</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">13</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">obj</span><span class="p">;</span>
<span class="linenos">14</span><span class="p">}</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">toAddress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">17</span><span class="w">    </span><span class="c1">// Java types</span>
<span class="linenos">18</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">EmailBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s2">&quot;org.simplejavamail.email.EmailBuilder&quot;</span><span class="p">);</span>
<span class="linenos">19</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">MailerBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s2">&quot;org.simplejavamail.mailer.MailerBuilder&quot;</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">TransportStrategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s2">&quot;org.simplejavamail.api.mailer.config.TransportStrategy&quot;</span><span class="p">);</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="w">    </span><span class="c1">// Build email</span>
<span class="linenos">23</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">serverConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">loadServerConfig</span><span class="p">();</span>
<span class="linenos">24</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">textBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">readFileToString</span><span class="p">(</span><span class="s2">&quot;emailTemplates/creation.txt&quot;</span><span class="p">);</span>
<span class="linenos">25</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">htmlBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">readFileToString</span><span class="p">(</span><span class="s2">&quot;emailTemplates/creation.html&quot;</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">EmailBuilder</span><span class="p">.</span><span class="nx">startingBlank</span><span class="p">()</span>
<span class="linenos">27</span><span class="w">        </span><span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="nx">toAddress</span><span class="p">)</span>
<span class="linenos">28</span><span class="w">        </span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">emailConfig</span><span class="p">.</span><span class="nx">fromAddress</span><span class="p">)</span>
<span class="linenos">29</span><span class="w">        </span><span class="p">.</span><span class="nx">withSubject</span><span class="p">(</span><span class="nx">emailConfig</span><span class="p">.</span><span class="nx">subject</span><span class="p">)</span>
<span class="linenos">30</span><span class="w">        </span><span class="p">.</span><span class="nx">withHTMLText</span><span class="p">(</span><span class="nx">htmlBody</span><span class="p">)</span>
<span class="linenos">31</span><span class="w">        </span><span class="p">.</span><span class="nx">withPlainText</span><span class="p">(</span><span class="nx">textBody</span><span class="p">)</span>
<span class="linenos">32</span><span class="w">        </span><span class="p">.</span><span class="nx">buildEmail</span><span class="p">();</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">mailerBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">MailerBuilder</span>
<span class="linenos">35</span><span class="w">        </span><span class="p">.</span><span class="nx">withSMTPServer</span><span class="p">(</span><span class="nx">serverConfig</span><span class="p">.</span><span class="nx">serverAddress</span><span class="p">,</span><span class="w"> </span><span class="nx">serverConfig</span><span class="p">.</span><span class="nx">serverPort</span><span class="p">,</span><span class="w"> </span><span class="nx">serverConfig</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span><span class="w"> </span><span class="nx">serverConfig</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span>
<span class="linenos">36</span><span class="w">        </span><span class="p">.</span><span class="nx">withSessionTimeout</span><span class="p">(</span><span class="mf">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="linenos">37</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">serverConfig</span><span class="p">.</span><span class="nx">enableStartTls</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">38</span><span class="w">        </span><span class="nx">mailerBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mailerBuilder</span><span class="p">.</span><span class="nx">withTransportStrategy</span><span class="p">(</span><span class="nx">TransportStrategy</span><span class="p">.</span><span class="nx">SMTP_TLS</span><span class="p">);</span>
<span class="linenos">39</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">serverConfig</span><span class="p">.</span><span class="nx">enableSmtps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">40</span><span class="w">        </span><span class="nx">mailerBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mailerBuilder</span><span class="p">.</span><span class="nx">withTransportStrategy</span><span class="p">(</span><span class="nx">TransportStrategy</span><span class="p">.</span><span class="nx">SMTPS</span><span class="p">);</span>
<span class="linenos">41</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">42</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">mailer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mailerBuilder</span><span class="p">.</span><span class="nx">buildMailer</span><span class="p">();</span>
<span class="linenos">43</span><span class="w">    </span><span class="nx">mailer</span><span class="p">.</span><span class="nx">sendMail</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>
<span class="linenos">44</span><span class="p">}</span>
<span class="linenos">45</span>
<span class="linenos">46</span><span class="kd">function</span><span class="w"> </span><span class="nx">loadServerConfig</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">47</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">readFileToString</span><span class="p">(</span><span class="s2">&quot;emailServerConfig.json&quot;</span><span class="p">);</span>
<span class="linenos">48</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
<span class="linenos">49</span><span class="p">}</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="kd">function</span><span class="w"> </span><span class="nx">readFileToString</span><span class="p">(</span><span class="nx">filename</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">52</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">dataDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">System</span><span class="p">.</span><span class="nx">getProperty</span><span class="p">(</span><span class="s2">&quot;cordra.data&quot;</span><span class="p">);</span>
<span class="linenos">53</span><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">nio</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">Paths</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">dataDir</span><span class="p">).</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">filename</span><span class="p">);</span>
<span class="linenos">54</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nb">String</span><span class="p">(</span><span class="nx">java</span><span class="p">.</span><span class="nx">nio</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">Files</span><span class="p">.</span><span class="nx">readAllBytes</span><span class="p">(</span><span class="nx">filePath</span><span class="p">));</span>
<span class="linenos">55</span><span class="p">}</span>
</pre></div>
</div>
<p>Next, try creating a new User in Cordra. You should receive an email containing the message specified in the JavaScript
configuration.</p>
<p>The email templates are loaded from the files we created before (lines 24-25). Be sure to modify <code class="docutils literal notranslate"><span class="pre">emailConfig</span></code> with
real email addresses to use for sending the email. Email server config is loaded from a local file in the
<code class="docutils literal notranslate"><span class="pre">loadServerConfig</span></code> function (lines 47-50), so the secrets are never network accessible through Cordra.</p>
<p>We are using <code class="docutils literal notranslate"><span class="pre">context.isNew</span></code> to make sure we only create a token on new object creation (line 10). The Java classes
from Simple Mail Client are loaded into the JavaScript (lines 18-20) and then used using the Simple Java Mail API (lines
26-44).</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>

<!-- BEGIN FOOTER -->
<footer id="footer">
    <div id="footer-main" class="container-large">
        <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-4">
                <div class="widget widget-text">
                    <h3 class="widget-title">Who are we?</h3>
                    <!-- <img width="200" height="50" class="footer-logo" src="_static/img/logo/cordra-light.png" alt="logo"> -->
                    <p>CNRI is a not-for-profit organization formed in 1986 to undertake, foster, and promote research on information infrastructure in the public interest.</p>
                    <p><i class="nc-icon-outline ui-1_home-minimal"></i> Corporation for National Research Initiatives</p>
                    <p><i class="nc-icon-outline location_position-marker"></i> 1895 Preston White Drive, Suite 100, Reston, Virginia 20191, USA</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 hidden-xs-down">
                <div class="widget widget-links">
                    <div class="widget-title">
                        <h3 class="widget-title">Quick Links</h3>
                    </div>
                    <ul>
                        <li>
                            <a href="/cordra.html">What's Cordra</a>
                        </li>
                        <li>
                            <a href="/download.html">Download</a>
                        </li>
                        <li>
                            <a href="/documentation/introduction/introduction.html">Developer Resources</a>
                        </li>
                        <li>
                            <a href="/download.html#section-licenses">Licenses</a>
                        </li>
                        <li>
                            <a href="/privacypolicy.html">Privacy Policy</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 hidden-md-down">
                <div class="widget">
                    <h3 class="widget-title">Contact Us</h3>
                    <p>Drop us an
                        <span class="f-18 c-white w-700 font-handwriting">
                            <a href="#" onclick="document.getElementById('emailAddress').style.display = 'block'; return false;" class="c-white">email.</a>
                            <span id="emailAddress" style="display: none;" class="c-white text-sm w-100">support@cordra.org</span>
                        </span>
                    </p>
                    <p>Join us on <a href="https://hdl.handle.net/20.5000/cordra-slack" target="_blank"><img width="100px" height="100px" src="../_static/img/slack_white.png" alt="Slack" class="m-l--10" /></a><span
                            class="f-18 c-white w-700 font-handwriting m-l--10">.</span></p>
                </div>
            </div>
        </div>
    </div>
    <div id="footer-bottom">
        <div class="container-large">
            <div class="row">
                <div class="col-sm-12 t-center">
                    <p class="copyright">Copyright&copy; 2020. Corporation for National Resesarch Initiatives. Cordra&reg; is a trademark of Corporation for National Research Initiatives.</p>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- END FOOTER -->

  </body>
</html> contentType 9 text/html url 71 https://www.cordra.org:443/documentation/extensions/sending-emails.html responseCode 3 200 