wgxiqeqkvgxqboocoacqzapqxejifceokomqliwc length 5 47178 page 47178 <!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>OAI-PMH in Cordra &#8212; Cordra  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/minimal-fixes.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sending Emails" href="sending-emails.html" />
    <link rel="prev" title="Digital Object Linking" href="object-linking.html" />
    <link rel="shortcut icon" href="../_static/img/favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700%7COpen+Sans:300,400,700,800' rel='stylesheet' />
    <link href='https://fonts.googleapis.com/css?family=Rasa:400,700%7COpen+Sans:300,400,700,800' rel='stylesheet' />
    <link rel="stylesheet" href="../_static/libs/font-awesome/css/font-awesome.min.css"></link>
    <link rel="stylesheet" href="../_static/libs/bootstrap/dist/css/bootstrap.min.css"></link>
    <link rel="stylesheet" href="../_static/icons/nucleo.css"></link>
    <link rel="stylesheet" href="../_static/libs/animate.css/animate.min.css"></link>
    <link rel="stylesheet" href="../_static/css/bootstrap.min.css"></link>
    <link rel="stylesheet" href="../_static/css/blog.css"></link>
    <link rel="stylesheet" href="../_static/css/buttons.css"></link>
    <link rel="stylesheet" href="../_static/css/colors.css"></link>
    <link rel="stylesheet" href="../_static/css/footers.css"></link>
    <link rel="stylesheet" href="../_static/css/widgets.css"></link>
    <link rel="stylesheet" href="../_static/css/nav.css"></link>
    <link rel="stylesheet" href="../_static/css/preloader.css"></link>
    <link rel="stylesheet" href="../_static/css/custom.css"></link>
    <link rel="stylesheet" href="../_static/css/ui.css"></link>

  </head><body>
<!-- BEGIN LATERAL NAVIGATION -->
<aside id="aside-nav">
    <div id="main-aside-navigation">
        <div class="main-nav-wrapper">
            <div class="close-aside-nav">
                <i class="nc-icon-outline ui-1_simple-remove"></i>
            </div>
            <div id="aside-logo">
                    <a href="/index.html" data-logo-light="../_static/img/cordra-light.png" data-logo-dark="../_static/img/cordra-primary-blue.png">
                    <img width="170" height="166" src="../_static/img/cordra-primary-blue.png" alt="logo">
                </a>
            </div>
            <nav id="main-aside-menu">
                <ul>
                    <li class="submenu">
                        <a href="/cordra.html">What's Cordra?</a>
                    </li>
                    <li class="submenu">
                        <a href="/getstarted.html">Get Started</a>
                    </li>
                    <li class="submenu">
                        <a href="/download.html">Download</a>
                    </li>
                    <li class="submenu">
                        <a href="/documentation/introduction/introduction.html">Developer Resources</a>
                    </li>
                    <li class="submenu">
                        <a href="/standards.html">Standards</a>
                    </li>
                    <li class="submenu">
                        <a href="../search.html">Search</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</aside>
<!-- END LATERAL NAVIGATION -->

<!-- BEGIN MAIN NAVIGATION -->
<header id="header">
    <div id="main-navigation">
        <div class="main-nav-wrapper">
            <div class="container-fluid">
                <div class="nav-left">
                    <div id="logo">
                        <a href="/index.html" data-logo-light="../_static/img/cordra-light.png" data-logo-dark="../_static/img/cordra-primary-blue.png">
                        <img width="145" height="36" src="../_static/img/cordra-primary-blue.png" alt="logo">
                        </a>
                    </div>
                </div>
                <div class="nav-right">
                    <nav id="main-menu">
                        <ul>
                            <li class="mega-menu menu-layouts">
                                <a href="/cordra.html">What's Cordra?</a>
                            </li>
                            <li class="mega-menu menu-layouts">
                                <a href="/getstarted.html">Get Started</a>
                            </li>
                            <li>
                                <a href="/download.html">Download</a>
                            </li>
                            <li class="mega-menu">
                                <a href="/documentation/introduction/introduction.html">Developer Resources</a>
                            </li>
                            <li class="mega-menu">
                                <a href="/standards.html">Standards</a>
                            </li>
                            <li class="mega-menu">
                                <a href="../search.html">Search</a>
                            </li>
                        </ul>
                    </nav>
                    <ul class="nav-tools">
                        <li class="mobile-menu-btn">
                            <button class="toggle-menu" data-toggle="mobile-menu" data-effect="hover">
                                <span class="menu-label label-left">Menu</span>
                                <i class="nc-icon-outline ui-2_menu-35"></i>
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- END MAIN NAVIGATION -->


  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://hdl.handle.net/20.1000/129">Developer Resources (in PDF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Cordra Software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/introduction.html">Introduction to Cordra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/release-notes.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/system-requirements.html">System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design/index.html">Application Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../design/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/identifiers.html">Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/schemas.html">Schemas/Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/design-object.html">Design Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/payloads.html">Payloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/authentication-and-access-controls.html">Authentication and Access Controls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/javascript-lifecycle-hooks.html">Lifecycle Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/type-methods.html">Type Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/java-hooks-and-methods.html">Java Hooks and Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/handle-integration.html">Handle Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/object-versioning.html">Digital Object Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/object-hashing.html">Digital Object Hashing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/doip.html">DOIP and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/doip-api-for-http-clients.html">DOIP API for HTTP Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/rest-api.html">HTTP REST API and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/search.html">Query Syntax</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../client/index.html">Clients</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../client/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/rest-java.html">REST - Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/javascript.html">REST - JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/doip-java.html">DOIP - Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/third-party.html">Third Party Clients</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/single-instance-deployment.html">Deploying Single-Instance Cordra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/single-instance-production.html">Production Single Instance Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/distributed-deployment.html">Deploying Cordra as a Distributed System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/reindexing.html">Reindexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/logs-management.html">Managing Cordra Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/storage-backends.html">Configuring Storage Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/indexing-backends.html">Configuring Indexing Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/sessions-manager.html">Distributed Sessions Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/user-management.html">Managing Users and Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/admin-user-interface.html">Administrative UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/enabling-tls.html">Enabling TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/https.html">Configuring HTTPS Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/migration.html">Migration across Cordra Environments</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Extensions and Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="calling-java-from-javascript.html">Calling Java from JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-repository.html">Document Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="medical-records-application.html">Medical Records Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="person-registry.html">Person Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="user-registration.html">User Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="object-linking.html">Digital Object Linking</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">OAI-PMH in Cordra</a></li>
<li class="toctree-l2"><a class="reference internal" href="sending-emails.html">Sending Emails</a></li>
<li class="toctree-l2"><a class="reference internal" href="external-authentication-provider.html">External Authentication Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="collab-prototype.html">Collab Prototype Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="neo4j-as-an-additional-index.html">Neo4j as an Additional Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="partial-replication-aggregation.html">Partial Replication/Aggregation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/import-export.html">Import and Export Tools</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="oai-pmh-in-cordra">
<span id="oai-pmh"></span><h1>OAI-PMH in Cordra<a class="headerlink" href="#oai-pmh-in-cordra" title="Permalink to this heading">¶</a></h1>
<p>We created a proof-of-concept to demonstrate how digital objects in Cordra can be disseminated via OAI-PMH. This is not a generic
application that automatically associates an OAI-PMH interface with any Cordra instance, but a specific demonstration that
we had put together that could act as a template or a starting point for Cordra projects with OAI-PMH needs.</p>
<p>For this proof-of-concept, we make use of sample Paper and Book types, and enable OAI-PMH access to objects of those
types. Paper type is a stand-in for an academic research paper, and Book type is a stand-in for published books.
Here are a few examples of OAI-PMH calls that will work in your local Cordra instance once the proof-of-concept is enabled:</p>
<section id="example-oai-pmh-urls">
<h2>Example OAI-PMH URLs<a class="headerlink" href="#example-oai-pmh-urls" title="Permalink to this heading">¶</a></h2>
<section id="identify">
<h3>Identify<a class="headerlink" href="#identify" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/cordra-oai-pmh/?verb=Identify
</pre></div>
</div>
</section>
<section id="listidentifiers">
<h3>ListIdentifiers<a class="headerlink" href="#listidentifiers" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/cordra-oai-pmh/?verb=ListIdentifiers&amp;from=2000-01-01T00:00:00Z&amp;metadataPrefix=oai_dc
</pre></div>
</div>
</section>
<section id="getrecord">
<h3>GetRecord<a class="headerlink" href="#getrecord" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/cordra-oai-pmh/?verb=GetRecord&amp;identifier=test/eb91eb599520927f9c8e&amp;metadataPrefix=oai_dc
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">test/eb91eb599520927f9c8e</span></code> is the id of a sample Cordra object. Replace it with an actual identifier if you are
not using the sample data.</p>
</section>
<section id="listrecords">
<h3>ListRecords<a class="headerlink" href="#listrecords" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/cordra-oai-pmh/?verb=ListRecords&amp;from=2000-01-01T00:00:00Z&amp;metadataPrefix=oai_dc

http://localhost:8080/cordra-oai-pmh/?verb=ListRecords&amp;resumptionToken=token_returned_from_a_previous_call
</pre></div>
</div>
</section>
<section id="listmetadataformats">
<h3>ListMetadataFormats<a class="headerlink" href="#listmetadataformats" title="Permalink to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/cordra-oai-pmh/?verb=ListMetadataFormats
</pre></div>
</div>
</section>
</section>
<section id="design">
<h2>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h2>
<p>Enabling OAI-PMH support within Cordra using our application requires two sets of capabilities:</p>
<ul class="simple">
<li><p>Metadata Translation: A capability that instructs the OAI-PMH interface how to convert Cordra objects into OAI-PMH
expected metadata. We enabled this capability as a set of <a class="reference internal" href="../design/type-methods.html#type-methods"><span class="std std-ref">Type Methods</span></a> that are configured on
each type of Cordra object meant for OAI-PMH based dissemination. These methods, at runtime, read the information
from a given Cordra object and produce bytes that are meaningful from a OAI-PMH dissemination standpoint. Details
about these specific methods are discussed in the following sections.</p></li>
<li><p>Protocol Interface: A capability that accepts OAI-PMH requests from users and invokes the aforementioned methods to
produce the desired responses. We enabled this as a Java servlet application that should be appropriately
configured to reach the Cordra it is fronting.</p></li>
</ul>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">¶</a></h2>
<p>The sample objects and servlet application required are included in the Cordra download, in the <code class="docutils literal notranslate"><span class="pre">extensions/oai-pmh</span></code>
directory.</p>
<section id="servlet-install">
<h3>Servlet Install<a class="headerlink" href="#servlet-install" title="Permalink to this heading">¶</a></h3>
<p>The Java servlet application war file should be placed in the <code class="docutils literal notranslate"><span class="pre">data/webapps/</span></code> directory of the Cordra deployment.
The data directory of the Cordra deployment should also contain a configuration file called <code class="docutils literal notranslate"><span class="pre">oai-pmh-config.json</span></code>.</p>
<p>Example configuration file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
    &quot;identity&quot; : {
        &quot;adminEmail&quot; : &quot;admin@example.com&quot;,
        &quot;baseURL&quot; : &quot;http://localhost:8080/cordra-oai-pmh/&quot;,
        &quot;repositoryName&quot; : &quot;Test&quot;
    },
    &quot;maxPageSize&quot; : 2,
    &quot;cordraBaseUri&quot; : &quot;http://localhost:8080/&quot;,
    &quot;cordraTypes&quot; : [&quot;Book&quot;, &quot;Paper&quot;]
}
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">identity</span></code> information in the configuration file is used by the servlet application to respond to Identify
verb requests.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">maxPageSize</span></code> property is used by the servlet application when list requests, i.e., <code class="docutils literal notranslate"><span class="pre">ListRecords</span></code> and
<code class="docutils literal notranslate"><span class="pre">ListIdentifiers</span></code>, are made. In the above example, it has been set to a very small number to demonstrate request
resumption tokens in a system that only contains a handful of objects. In a production deployment this number should
be set to something much larger.</p>
<p><code class="docutils literal notranslate"><span class="pre">cordraBaseUri</span></code> is the URI to which the Java servlet application connects to interact with the Cordra HTTP API. Since the Java
servlet application is run on the same environment as Cordra in our proof of concept, the above example refers to the
Cordra instance deployed at the localhost.</p>
<p><code class="docutils literal notranslate"><span class="pre">cordraTypes</span></code> lists the types of objects in the Cordra instance that should be made available to the OAI-PMH
interface. For example, you might have objects of type Group or User that you do not want to expose over this interface.
In the example deployment, two different types are used, Paper which represents the metadata of an academic research
paper, and Book which represents the metadata for a published book.</p>
</section>
<section id="type-methods">
<h3>Type Methods<a class="headerlink" href="#type-methods" title="Permalink to this heading">¶</a></h3>
<p>The zip file download includes the necessary type object for our example application, in addition to a few sample
objects. There is also a type called <code class="docutils literal notranslate"><span class="pre">OaiUtil</span></code> that contains some Javascript methods that are used by the Book
and Paper types.</p>
<p>You can load the objects using the Cordra UI. Sign in into Cordra as <code class="docutils literal notranslate"><span class="pre">admin</span></code> and select the <code class="docutils literal notranslate"><span class="pre">Admin-&gt;Types</span></code>
dropdown menu. Click the “Load from file” button. In the dialog that pops up, select the <code class="docutils literal notranslate"><span class="pre">oai-pmh-objects.json</span></code> file
you downloaded and check the box to delete existing objects. Click “Load” to import the objects into Cordra.</p>
<p>To see examples of the methods described below, sign in as admin to the Cordra UI look at the Book and Paper types.</p>
<p>For details about how to write methods like these in Cordra, please refer to <a class="reference internal" href="../design/type-methods.html#type-methods"><span class="std std-ref">Type Methods</span></a>.</p>
</section>
<section id="authorization">
<h3>Authorization<a class="headerlink" href="#authorization" title="Permalink to this heading">¶</a></h3>
<p>The type methods should be configured such that they can be publicly accessed (so that the servlet
application can access them without any specific credentials). To do that, in the <code class="docutils literal notranslate"><span class="pre">Admin-&gt;Authorization</span></code> section of
the Cordra UI, replace the default Authorization config with the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
  &quot;schemaAcls&quot;: {
    &quot;Book&quot;: {
      &quot;defaultAclRead&quot;: [
        &quot;public&quot;
      ],
      &quot;defaultAclWrite&quot;: [
        &quot;public&quot;
      ],
      &quot;aclCreate&quot;: [],
      &quot;aclMethods&quot;: {
        &quot;default&quot;: {
          &quot;instance&quot;: [
            &quot;public&quot;
          ],
          &quot;static&quot;: [
            &quot;public&quot;
          ]
        }
      }
    },
    &quot;Paper&quot;: {
      &quot;defaultAclRead&quot;: [
        &quot;public&quot;
      ],
      &quot;defaultAclWrite&quot;: [
        &quot;public&quot;
      ],
      &quot;aclCreate&quot;: [],
      &quot;aclMethods&quot;: {
        &quot;default&quot;: {
          &quot;instance&quot;: [
            &quot;public&quot;
          ],
          &quot;static&quot;: [
            &quot;public&quot;
          ]
        }
      }
    },
    &quot;CordraDesign&quot;: {
      &quot;defaultAclRead&quot;: [
        &quot;public&quot;
      ],
      &quot;defaultAclWrite&quot;: [],
      &quot;aclCreate&quot;: []
    },
    &quot;Schema&quot;: {
      &quot;defaultAclRead&quot;: [
        &quot;public&quot;
      ],
      &quot;defaultAclWrite&quot;: [],
      &quot;aclCreate&quot;: []
    }
  },
  &quot;defaultAcls&quot;: {
    &quot;defaultAclRead&quot;: [
      &quot;public&quot;
    ],
    &quot;defaultAclWrite&quot;: [
      &quot;creator&quot;
    ],
    &quot;aclCreate&quot;: [
      &quot;authenticated&quot;
    ]
  }
}
</pre></div>
</div>
<p>This configuration enables public access to all instance and static methods on Book and Paper types.</p>
</section>
<section id="metadata-translation-using-javascript">
<h3>Metadata Translation using JavaScript<a class="headerlink" href="#metadata-translation-using-javascript" title="Permalink to this heading">¶</a></h3>
<p>The proof of concept enables five OAI-PMH request verbs: Identify, ListIdentifiers, GetRecord, ListRecords, and
ListMetadataFormats.</p>
<ul class="simple">
<li><p>Identify: The information necessary to respond to the Identify verb is already configured with the servlet application
(see next section for details). As such, no specific support for this verb at Cordra is needed.</p></li>
<li><p>ListIdentifiers: Cordra’s REST API already supports listing identifiers of Cordra objects of a given type. As such,
no specific Type method is required to support this verb.</p></li>
<li><p>GetRecord: OAI-PMH expects a metadata description for each object. At the minimum for such description, OAI-PMH expects
a DC format, which is short for XML serialization of metadata that uses properties from Dublin Core specification.
OAI-PMH allows metadata descriptions in other formats. Because information in Cordra objects need not be readily
available for dissemination per OAI-PMH, Type methods are required to translate Cordra objects to meet OAI-PMH needs.
One method getAsXml should be associated with each type of Cordra object. That method should have instructions to
convert information from the Cordra object into the desired XML. If the intention is to just produce XML that
conforms to DC format, a convenience method <code class="docutils literal notranslate"><span class="pre">getAsDublinCoreJson</span></code> can be used instead. This method expects a
JSON object containing various DC fields. The OAI-PMH servlet application is hard-wired to execute either of these
methods depending on the user request. Example code for these two methods is listed in the Appendix.</p></li>
<li><p>ListRecords: ListRecords is, in effect, a listing of all records where each record corresponds to the GetRecord
response for a given object. As such, the methods discussed above are sufficient for the servlet application to
fulfill user requests that correspond to this verb.</p></li>
<li><p>ListMetadataFormats: As mentioned above, metadata formats other than DC can be supported by an OAI-PMH interface.
Because Cordra objects are typed, each type should indicate the supported metadata formats. A method
<code class="docutils literal notranslate"><span class="pre">listMetadataFormats</span></code> should be used to return a list of supported formats. Example code is listed in the Appendix.</p></li>
</ul>
</section>
<section id="protocol-interface-servlet-application">
<h3>Protocol Interface Servlet Application<a class="headerlink" href="#protocol-interface-servlet-application" title="Permalink to this heading">¶</a></h3>
<p>A Java servlet application was developed for this proof of concept that performs three actions:</p>
<ul class="simple">
<li><p>It accepts valid OAI-PMH requests from users,</p></li>
<li><p>It invokes appropriate Cordra APIs (and in turn invokes appropriate Type methods wherever applicable) to
retrieve information for a given user request, and</p></li>
<li><p>It serializes the retrieved information to the desired form and responds back to the users.</p></li>
</ul>
</section>
<section id="resumption-token">
<h3>Resumption Token<a class="headerlink" href="#resumption-token" title="Permalink to this heading">¶</a></h3>
<p>Resumption token, according to OAI-PMH, is a token that enables clients to retrieve the next set of results for a
given request when the total number of results are deemed large enough to require multiple responses. The resumption
token is implemented as a stateless string: a base64 encoding of the bytes of a JSON string that when
decoded informs Cordra the next set of Cordra objects that should be returned. For example, the decoded information may
look like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&quot;txnId&quot;:1557422842749010,&quot;from&quot;:&quot;2000-01-01T00:00:00Z&quot;,&quot;metadataPrefix&quot;:&quot;oai_dc&quot;}
</pre></div>
</div>
</section>
</section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this heading">¶</a></h2>
<p>Metadata for the OAI-PMH results are generated at runtime using Type methods. In particular, the Java servlet
application knows to invoke specific methods that are attached to the applicable types. Those methods are <code class="docutils literal notranslate"><span class="pre">getAsXml</span></code>,
<code class="docutils literal notranslate"><span class="pre">getAsDublinCoreJson</span></code>, and <code class="docutils literal notranslate"><span class="pre">listMetadataFormats</span></code>.</p>
<section id="getasxml">
<h3>getAsXml<a class="headerlink" href="#getasxml" title="Permalink to this heading">¶</a></h3>
<p>This method expects two arguments: the instance of the Cordra object and a context object. In this case, the context
object will contain a string property context.params.format. The value of this property will contain the metadataPrefix
of the originating OAI-PMH call. Your code should branch on the value of this property and construct an XML string in
the requested format. The function should return that XML string. If you do not want this type of object to support the
requested format you should throw an exception like this:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">format</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;oai_custom_1&quot;</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">format</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="s2">&quot;Format not supported&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>If your object does support the requested format, construct an XML string and return it. An example is shown below:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">paper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cordraObject</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">xml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;paper&gt;&#39;</span><span class="p">;</span>
<span class="nx">xml</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;identifier&gt;&#39;</span><span class="o">+</span><span class="w"> </span><span class="nx">cordraObject</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;&lt;/identifier&gt;&#39;</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">paper</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">xml</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;title&gt;&#39;</span><span class="o">+</span><span class="nx">paper</span><span class="p">.</span><span class="nx">title</span><span class="o">+</span><span class="s1">&#39;&lt;/title&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">paper</span><span class="p">.</span><span class="kr">abstract</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">xml</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;abstract&gt;&#39;</span><span class="o">+</span><span class="nx">paper</span><span class="p">.</span><span class="kr">abstract</span><span class="o">+</span><span class="s1">&#39;&lt;/abstract&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">xml</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/paper&gt;&#39;</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="nx">xml</span><span class="p">;</span>
</pre></div>
</div>
<p>In the example on the Book type, an included utility function <code class="docutils literal notranslate"><span class="pre">oaiUtil.toXml()</span></code> is used to generate the XML from the
JSON of the object automatically.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cordraObject</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">xml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">oaiUtil</span><span class="p">.</span><span class="nx">toXml</span><span class="p">(</span><span class="s2">&quot;book&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">book</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">oaiUtil.toXml()</span></code> is implemented for this proof-of-concept; as implemented, this method <code class="docutils literal notranslate"><span class="pre">toXml()</span></code> does not
support attributes, and implements one specific way of representing lists of elements. It is included here solely to
provide a starting point, one way in which a developer might choose to generate their specific XML records.</p>
</section>
<section id="getasdublincorejson">
<h3>getAsDublinCoreJson<a class="headerlink" href="#getasdublincorejson" title="Permalink to this heading">¶</a></h3>
<p>The XML serialization of Dublin Core metadata is a known structure to the servlet application. As such a utility is
provided that can automatically convert a specific JSON object with correctly named properties into a Dublin Core XML
record. The return value of the method getAsDublinCoreJson should be a JSON object with property names that match the
15 terms from the Dublin Core set:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;creator&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;subject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;description&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;publisher&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;contributor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;date&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;identifier&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;source&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;language&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;relation&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;coverage&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;rights&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>You can either include a single top level property, or if you want to include more than one property of that type, you
can use an array with the same name like in this example:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">dcJson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;title&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;foo&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;creator&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Alice&quot;</span><span class="p">]</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The Java servlet application (cordra-oai-pmh.war) will automatically convert the returned JSON object into Dublin Core compatible
XML including the <code class="docutils literal notranslate"><span class="pre">dc:</span></code> prefix to the property names.</p>
<p>An additional utility method <code class="docutils literal notranslate"><span class="pre">oaiUtil.mapTo()</span></code> can be used to map the values on the input Cordra object to the desired
output properties. It takes a map from output property name to path of input property, like this:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;subject&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/genre&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;creator&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/authors&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;publisher&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/publishedBy&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;language&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/language&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;date&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/publicationDate&quot;</span>
<span class="p">};</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">dcJson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">oaiUtil</span><span class="p">.</span><span class="nx">mapTo</span><span class="p">(</span><span class="nx">cordraObject</span><span class="p">,</span><span class="w"> </span><span class="nx">map</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>listMetadataFormats<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>For each type of digital object that you are using with OAI-PMH, the metadata formats must be explicitly listed. This is done by
implementing and exporting the following JavaScript method, like this:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">exports</span><span class="p">.</span><span class="nx">staticMethods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">staticMethods</span><span class="p">.</span><span class="nx">listMetadataFormats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">listMetadataFormats</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">listMetadataFormats</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="s2">&quot;metadataPrefix&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;oai_dc&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;schema&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;http://www.openarchives.org/OAI/2.0/oai_dc.xsd&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;metadataNamespace&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;http://www.openarchives.org/OAI/2.0/oai_dc/&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="s2">&quot;metadataPrefix&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;oai_custom_1&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>

<!-- BEGIN FOOTER -->
<footer id="footer">
    <div id="footer-main" class="container-large">
        <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-4">
                <div class="widget widget-text">
                    <h3 class="widget-title">Who are we?</h3>
                    <!-- <img width="200" height="50" class="footer-logo" src="_static/img/logo/cordra-light.png" alt="logo"> -->
                    <p>CNRI is a not-for-profit organization formed in 1986 to undertake, foster, and promote research on information infrastructure in the public interest.</p>
                    <p><i class="nc-icon-outline ui-1_home-minimal"></i> Corporation for National Research Initiatives</p>
                    <p><i class="nc-icon-outline location_position-marker"></i> 1895 Preston White Drive, Suite 100, Reston, Virginia 20191, USA</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 hidden-xs-down">
                <div class="widget widget-links">
                    <div class="widget-title">
                        <h3 class="widget-title">Quick Links</h3>
                    </div>
                    <ul>
                        <li>
                            <a href="/cordra.html">What's Cordra</a>
                        </li>
                        <li>
                            <a href="/download.html">Download</a>
                        </li>
                        <li>
                            <a href="/documentation/introduction/introduction.html">Developer Resources</a>
                        </li>
                        <li>
                            <a href="/download.html#section-licenses">Licenses</a>
                        </li>
                        <li>
                            <a href="/privacypolicy.html">Privacy Policy</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 hidden-md-down">
                <div class="widget">
                    <h3 class="widget-title">Contact Us</h3>
                    <p>Drop us an
                        <span class="f-18 c-white w-700 font-handwriting">
                            <a href="#" onclick="document.getElementById('emailAddress').style.display = 'block'; return false;" class="c-white">email.</a>
                            <span id="emailAddress" style="display: none;" class="c-white text-sm w-100">support@cordra.org</span>
                        </span>
                    </p>
                    <p>Join us on <a href="https://hdl.handle.net/20.5000/cordra-slack" target="_blank"><img width="100px" height="100px" src="../_static/img/slack_white.png" alt="Slack" class="m-l--10" /></a><span
                            class="f-18 c-white w-700 font-handwriting m-l--10">.</span></p>
                </div>
            </div>
        </div>
    </div>
    <div id="footer-bottom">
        <div class="container-large">
            <div class="row">
                <div class="col-sm-12 t-center">
                    <p class="copyright">Copyright&copy; 2020. Corporation for National Resesarch Initiatives. Cordra&reg; is a trademark of Corporation for National Research Initiatives.</p>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- END FOOTER -->

  </body>
</html> contentType 9 text/html url 64 https://www.cordra.org:443/documentation/extensions/oai-pmh.html responseCode 3 200 